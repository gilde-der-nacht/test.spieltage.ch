import{g as d,a as s,i,c as r,t as u,S as c}from"./web.D8V8UMPF.js";import{e as F,u as O,o as w,s as V,l as _,I as x,B as h,a as G,b as H}from"./utils.BOPG8k7O.js";import{c as q}from"./store.B96L5sdd.js";var J=u("<a href=/kontakt>Kontaktformular"),K=u("<a href=/chat>Chat"),W=u("<form novalidate><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),Q=u("<a href=/kontakt>kontaktiere uns direkt"),X=u("<div style=margin-block-start:1rem>");function te(){const[e,n]=q({form:{name:"",email:"",mobile:""},showErrors:{nameMissing:!1,emailMissing:!1,emailInvalid:!1,emailDuplicate:!1,general:!1},state:"IDLE"});let p;async function D(t){t.preventDefault();const $=e.form.name.trim().length===0;n("showErrors","nameMissing",$);const f=e.form.email.trim().length===0;n("showErrors","emailMissing",f);const b=p.validity.typeMismatch;if(n("showErrors","emailInvalid",b),!(e.showErrors.nameMissing||e.showErrors.emailMissing||e.showErrors.emailInvalid)){n("state","LOADING");try{const m={name:e.form.name,email:e.form.email,mobile:e.form.mobile},g=await fetch(F("/lst26/start"),{method:"post",body:JSON.stringify(m),headers:{"Content-Type":"application/json"}});if(!g.ok)n("showErrors","general",!0);else{const E=await g.json(),l=O([w({kind:_("SUCCESS"),data:w({secret:V()})}),w({kind:_("FAILURE"),reason:_("DUPLICATE_EMAIL")})]).parse(E);if(n("showErrors","emailDuplicate",l.kind==="FAILURE"&&l.reason==="DUPLICATE_EMAIL"),l.kind==="SUCCESS"){const o=new URL(location.origin+"/meine-anmeldung");o.searchParams.append("secret",l.data.secret),o.searchParams.append("showCreateMessage","true"),window.location.href=`${o.origin}${o.pathname}#/${o.search}`}}}catch(m){console.error(m),n("showErrors","general",!0)}finally{n("state","IDLE")}}}return[(()=>{var t=d(W),$=t.firstChild,[f,b]=s($.nextSibling),m=f.nextSibling,[g,E]=s(m.nextSibling),S=g.nextSibling,[l,o]=s(S.nextSibling),L=l.nextSibling,[y,A]=s(L.nextSibling),C=y.nextSibling,[I,U]=s(C.nextSibling),P=I.nextSibling,[k,T]=s(P.nextSibling),N=k.nextSibling,[v,B]=s(N.nextSibling),j=v.nextSibling,[R,z]=s(j.nextSibling);return t.addEventListener("submit",D),i(t,r(x,{label:"Name",name:"name",get value(){return e.form.name},onValueUpdate:a=>{n("form","name",a),n("showErrors","nameMissing",!1)}}),f,b),i(t,r(c,{get when(){return e.showErrors.nameMissing},get children(){return r(h,{type:"danger",children:"Dies ist ein Pflichtfeld."})}}),g,E),i(t,r(G,{label:"E-Mail",name:"email",type:"email",get value(){return e.form.email},onValueUpdate:a=>{n("form","email",a),n("showErrors","emailMissing",!1),n("showErrors","emailInvalid",!1)},ref(a){var M=p;typeof M=="function"?M(a):p=a}}),l,o),i(t,r(c,{get when(){return e.showErrors.emailMissing},get children(){return r(h,{type:"danger",children:"Dies ist ein Pflichtfeld."})}}),y,A),i(t,r(c,{get when(){return e.showErrors.emailInvalid},get children(){return r(h,{type:"danger",children:"Die Eingabe scheint keine gültige E-Mail-Adresse zu sein."})}}),I,U),i(t,r(c,{get when(){return e.showErrors.emailDuplicate},get children(){return r(h,{type:"danger",get children(){return["Diese E-Mail wird bereits verwendet. Du solltest einen persönlichen Link erhalten haben, um deine fortzusetzen. Benötigst du Hilfe, dann kontaktiere uns bitte über das"," ",d(J)," oder unseren"," ",d(K),"."]}})}}),k,T),i(t,r(x,{label:"Handynummer (optional)",name:"mobile",type:"tel",get value(){return e.form.mobile},required:!1,onValueUpdate:a=>n("form","mobile",a)}),v,B),i(t,r(H,{type:"submit",get kind(){return e.state==="IDLE"?"success":"gray"},get label(){return e.state==="IDLE"?"Anmeldung starten":"Anmeldung wird gestartet"},get disabled(){return e.state==="LOADING"}}),R,z),t})(),r(c,{get when(){return e.showErrors.general},get children(){var t=d(X);return i(t,r(h,{type:"danger",get children(){return["Es gab ein Problem, das wir nicht erwartet haben. Bitte versuche es erneut oder ",d(Q),"."]}})),t}})]}export{te as Anmeldung};
