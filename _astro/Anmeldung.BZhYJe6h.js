import{g as b,c as n,a as i,i as s,t as E,S as d}from"./web.x3tUugcc.js";import{e as C,I as x,B as h,a as O,b as T}from"./utils.CBJVEUl0.js";import{c as V}from"./store.BsFZ2DX6.js";import{o as G,s as u}from"./index.DrKGDYo5.js";var R=E("<form novalidate><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),q=E("<br>"),z=E("<a href=/kontakt>kontaktiere uns direkt");function K(){const[e,t]=V({form:{name:"",email:"",tel:""},showErrors:{nameMissing:!1,emailMissing:!1,emailInvalid:!1,general:!1},state:"IDLE"});let f;async function M(r){r.preventDefault();const p=e.form.name.trim().length===0;t("showErrors","nameMissing",p);const g=e.form.email.trim().length===0;t("showErrors","emailMissing",g);const $=f.validity.typeMismatch;if(t("showErrors","emailInvalid",$),!(e.showErrors.nameMissing||e.showErrors.emailMissing||e.showErrors.emailInvalid)){t("state","LOADING");try{const l={name:e.form.name,email:e.form.email,telephone:e.form.tel},o=await fetch(C("/lst25/start"),{method:"post",body:JSON.stringify(l),headers:{"Content-Type":"application/json"}});if(!o.ok)t("showErrors","general",!0);else{const w=await o.json(),c=G({name:u(),email:u(),registrationUuid:u(),secret:u()}).parse(w),m=new URL(location.origin+"/meine-anmeldung");m.searchParams.append("secret",c.secret),m.searchParams.append("showCreateMessage","true"),window.location.replace(m)}}catch(l){console.error(l),t("showErrors","general",!0)}finally{t("state","IDLE")}}}return[(()=>{var r=b(R),p=r.firstChild,[g,$]=i(p.nextSibling),l=g.nextSibling,[o,w]=i(l.nextSibling),_=o.nextSibling,[c,m]=i(_.nextSibling),D=c.nextSibling,[y,k]=i(D.nextSibling),L=y.nextSibling,[S,A]=i(L.nextSibling),N=S.nextSibling,[I,P]=i(N.nextSibling),U=I.nextSibling,[j,B]=i(U.nextSibling);return r.addEventListener("submit",M),s(r,n(x,{label:"Name",name:"name",get value(){return e.form.name},onValueUpdate:a=>{t("form","name",a),t("showErrors","nameMissing",!1)}}),g,$),s(r,n(d,{get when(){return e.showErrors.nameMissing},get children(){return n(h,{type:"danger",children:"Dies ist ein Pflichtfeld."})}}),o,w),s(r,n(O,{label:"E-Mail",name:"email",type:"email",get value(){return e.form.email},onValueUpdate:a=>{t("form","email",a),t("showErrors","emailMissing",!1),t("showErrors","emailInvalid",!1)},ref(a){var v=f;typeof v=="function"?v(a):f=a}}),c,m),s(r,n(d,{get when(){return e.showErrors.emailMissing},get children(){return n(h,{type:"danger",children:"Dies ist ein Pflichtfeld."})}}),y,k),s(r,n(d,{get when(){return e.showErrors.emailInvalid},get children(){return n(h,{type:"danger",children:"Die Eingabe scheint keine gÃ¼ltige E-Mail-Adresse zu sein."})}}),S,A),s(r,n(x,{label:"Handynummer (optional)",name:"tel",type:"tel",get value(){return e.form.tel},required:!1,onValueUpdate:a=>t("form","tel",a)}),I,P),s(r,n(T,{type:"submit",get kind(){return e.state==="IDLE"?"success":"gray"},get label(){return e.state==="IDLE"?"Anmeldung starten":"Anmeldung wird gestartet"},get disabled(){return e.state==="LOADING"}}),j,B),r})(),b(q),n(d,{get when(){return e.showErrors.general},get children(){return n(h,{type:"danger",get children(){return["Es gab ein Problem, das wir nicht erwartet haben. Bitte versuche es erneut oder ",b(z),"."]}})}})]}export{K as Anmeldung};
