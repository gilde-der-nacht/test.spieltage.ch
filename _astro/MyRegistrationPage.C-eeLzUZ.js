import{c as nt,o as F,n as de,s as U,e as Be,d as Ae,u as ze,l as le,q as ce,f as bn,g as Sn,h as Bt,i as ue,B as E,j as me,p as pt,N as At,r as _n,b as oe,k as Ue,I as zt,m as Se,S as Rt,t as mt,v as Ge,w as vn,x as kn,y as yn,z as xn}from"./utils.e6z2UOng.js";import{g,a as m,i as u,c as l,t as $,r as Mt,h as ne,j as jt,k as bt,l as Kt,e as ie,b as K,n as St,p as _t,q as Dn,w as En,x as pn,y as An,z as Rn,A as z,S as D,B as wn,C as Wt,D as it,E as vt,m as wt,G as Tn,H as Un,I as Qe,s as ye,J as Cn,M as he,F as J,f as Me,K as xe,L as lt,N as je,O as Pn,u as Fn,d as fe,P as Zt,Q as Vt,R as Ve}from"./web.BGDrlDKA.js";import{c as ve,u as Ln}from"./store.XlVLhlw3.js";import{E as $e}from"./ExitSpa.B46xHIx7.js";import{T as In}from"./Textarea.Df3zblOd.js";const[Ye,Xe]=ve([]);function qt(e,t){if(t?.uuid!==void 0&&Ye.find(o=>o.uuid===t.uuid)!==void 0)return $t(t.uuid,e,t);const n=t?.uuid??crypto.randomUUID(),r=t?.duration??5e3,i=t?.kind??"gray",a=t?.dismissable??!0,s=setTimeout(()=>{Xe(Ye.filter(o=>o.uuid!==n))},r);return Xe(Ye.length,{uuid:n,kind:i,message:e,duration:r,dismissable:a,cleanup:()=>clearTimeout(s)}),n}function $t(e,t,n){const r=Ye.find(c=>c.uuid===e);if(r===void 0)return e;r.cleanup();const i=n.duration??r.duration,a=n.kind??r.kind,s=n?.dismissable??r.dismissable,o=setTimeout(()=>{Xe(Ye.filter(c=>c.uuid!==e))},i);return Xe(c=>c.uuid===e,{uuid:e,kind:a,message:t,duration:i,dismissable:s,cleanup:()=>clearTimeout(o)}),e}const Nn=nt(["SATURDAY","SUNDAY"]);F({uuid:U().uuid(),day:Nn,from:de(),to:de()}).refine(e=>e.from<e.to,{message:"A TimeSlot can't end before it starts."});F({name:U(),label:U(),description:U()});const Jt=nt(["draft","published","archived"]);async function Yn(e){const t=new URL(Be("/lst26/load"));t.searchParams.append("secret",e);const n=await fetch(t);if(!n.ok)return{kind:"FAILURE"};const r=await n.json();return typeof r=="object"&&r!==null?{kind:"SUCCESS",data:r}:(console.error("`last_save` not found on ",r),{kind:"FAILURE"})}async function On(e,t){try{const n=await fetch(Be("/lst26/save"),{method:"POST",body:JSON.stringify({secret:t,save:e}),headers:{"Content-Type":"application/json"}});return n.ok?{kind:"SUCCESS",data:t}:(console.error(await n.text()),{kind:"FAILURE"})}catch(n){return console.error(n),{kind:"FAILURE"}}}async function Hn(){try{const e=new URL(Be("/lst26/public")),t=await fetch(e,{headers:{"Content-Type":"application/json"}});return t.ok?{kind:"SUCCESS",data:await t.json()}:(console.error(await t.text()),{kind:"FAILURE"})}catch(e){return console.error(e),{kind:"FAILURE"}}}async function Bn(e){try{const t=new URL(Be("/lst26/public/admin"));t.searchParams.append("secret",e);const n=await fetch(t,{headers:{"Content-Type":"application/json"}});return n.ok?{kind:"SUCCESS",data:await n.json()}:(console.error(await n.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}nt(["SAVING","IDLE","ERROR"]);const zn=Ae(ze([le("admin"),le("erklaerbaer")])),et=nt(["FRIDAY","SATURDAY","SUNDAY"]),Mn=F({from:de(),to:de()}),jn=Mn.extend({day:et});function Ze(e,t){const{startTime:n,endTime:r}=Kn(t);return!(n.hour>e.hour||n.hour===e.hour&&n.minute>e.minute||r.hour<e.hour||r.hour===e.hour&&r.minute<e.minute)}function Kn(e){const{startTime:t,endTime:n}=e;return{startTime:t.hour===0&&t.minute===0?ce.PlainTime.from({hour:23,minute:59}):t,endTime:n.hour===0&&n.minute===0?ce.PlainTime.from({hour:23,minute:59}):n}}function Wn(e,t){const{startTime:n,endTime:r}=e,{startTime:i,endTime:a}=t;return Ze(n,t)||Ze(r,t)||Ze(i,e)||Ze(a,e)||n===i&&r===a}function Zn(e,t=!1){const{from:n,to:r}=e;if(n>r)return[];const i=r-n;return Gt(t?i+1:i,n)}function Gt(e,t=0){return[...Array(e)].map((n,r)=>r+t)}function Ce(e,t){const{minutes:n}=t??{minutes:!0};return n?`${e.hour}.${e.minute.toString().padStart(2,"0")}`:`${e.hour}`}function Vn(e,t){const n=e.minute+e.hour*60,r=t.minute+t.hour*60,i=Math.abs(r-n),a=i%60,s=Math.round((i-a)/60);return a===0?`${s} ${s===1?"Stunde":"Stunden"}`:s===0?`${a} ${a===1?"Minute":"Minuten"}`:`${s},${a} Stunden`}const qn=F({name:U(),email:U(),mobile:U()}),Jn=F({kind:le("ERKLAERBAER"),uuid:U().uuid(),slot:jn}),Gn=ze([F({kind:le("SELF"),helpEntryUuid:U().uuid(),uuid:U().uuid()}),F({kind:le("FRIEND"),helpEntryUuid:U().uuid(),name:U(),uuid:U().uuid()}),Jn]),Qn=F({uuid:U(),start:F({day:et,time:U()}),end:F({day:et,time:U()})}),Xn=ze([F({kind:le("NONE"),maxSeats:de()}),F({kind:le("LIMITED"),maxSeats:de()})]),er=F({uuid:U().uuid(),status:Jt,title:U(),organizer:U(),shortDescription:U(),longDescription:U(),participating:Xn,timeSlots:Ae(Qn),tagNames:U()}),tr=F({}),nr=F({version:le(9),contact:qn,config:F({wantsUpdates:bn()}),helping:Ae(Gn),program:F({organising:Ae(er),participating:Ae(tr)})}),rr=F({kind:le("SUCCESS"),status:Jt,roles:zn,data:nr});async function ir(e){if(e.length!==36&&e.length!==4)return{kind:"FAILURE",reason:"SECRET_INVALID"};const t=await Yn(e);if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE",reason:"GENERAL"};const n=rr.safeParse(t.data);return n.success?{kind:"SUCCESS",data:n.data}:(console.error(n.error),{kind:"FAILURE",reason:"PARSE_ERROR"})}const at=crypto.randomUUID();async function lr(e,t,n){const[r,i]=ve(e);i("saveState","SAVING"),qt("Am Speichern...",{uuid:at,dismissable:!1});const a=new Date;try{if((await On(t,n)).kind==="FAILURE")throw Error("")}catch(s){return i("saveState","ERROR"),console.error(s),$t(at,"Speichern war nicht möglich!",{kind:"danger",duration:1e4,dismissable:!0}),{kind:"FAILURE"}}return $t(at,`Zuletzt gespeichert um: ${Bt(a)} Uhr`,{kind:"success",dismissable:!0}),i("saveState","IDLE"),{kind:"SUCCESS",data:a}}const ar=Sn(lr,1e3);var Tt=$("<br>"),sr=$("<strong>Donnerstag, 21. August 2025"),ur=$("<p>Deine Anmeldung wird geladen..."),or=$("<p>Das Programm wird geladen..."),cr=$("<p>Leider ist ein unerwarteter Fehler passiert. Versuche deine Anmeldung erneut zu laden. Wiederholt sich dieser Fehler, bitte kontaktiere uns sobald als möglich über das <!$><!/>, da dies nicht passieren sollte."),dr=$("<p>Wir konnten leider keine Anmeldung finden. Wenn du bereits eine Anmeldung begonnen hast, solltest du den korrekten Link per E-Mail erhalten haben.<br><br> Falls du noch keine Anmeldung begonnen hast, kannst du <!$><!/> deine persönliche Anmeldung beginnen. <br><br>Für generelle Fragen oder Probleme, schreibe uns doch bitte über unser <!$><!/>."),gr=$("<p>Wir konnten leider keine Spielrunde unter diesem Link finden.<br><br>Vermutlich liegt es an uns. Bitte kontaktiere uns sobald als möglich über das "),hr=$("<p>Leider ist ein unerwarteter Fehler passiert. Vermutlich liegt es an uns. Bitte kontaktiere uns sobald als möglich über das <!$><!/>."),mr=$("<p>Leider ist ein unerwarteter Fehler passiert beim Laden des Programmes. Vermutlich liegt es an uns. Bitte kontaktiere uns sobald als möglich über das <!$><!/>."),$r=$("<p>Leider ist ein unerwarteter Fehler passiert beim Laden von Daten. Vermutlich liegt es an uns. Bitte kontaktiere uns sobald als möglich über das <!$><!/>."),fr=$("<p>Leider ist das keine gültige Seite. Versuche deine Anmeldung erneut zu laden. Wiederholt sich dieser Fehler, bitte kontaktiere uns sobald als möglich über das <!$><!/>, da dies nicht passieren sollte."),br=$("<p>Leider hast du keinen Zugriff auf diese Seite. Sollte dies ein Fehler sein, dann kontaktiere uns sobald als möglich über das <!$><!/>.");g(Tt),g(Tt),g(sr);const Sr={registration:g(ur),program:g(or)},_r={general:(()=>{var e=g(cr),t=e.firstChild,n=t.nextSibling,[r,i]=m(n.nextSibling);return r.nextSibling,u(e,l($e,{href:"/kontakt",children:"Kontaktformular"}),r,i),e})(),secretError:(()=>{var e=g(dr),t=e.firstChild,n=t.nextSibling,r=n.nextSibling,i=r.nextSibling,a=i.nextSibling,[s,o]=m(a.nextSibling),c=s.nextSibling,d=c.nextSibling,h=d.nextSibling,b=h.nextSibling,v=b.nextSibling,[S,k]=m(v.nextSibling);return S.nextSibling,u(e,l($e,{href:"/anmeldung",children:"hier"}),s,o),u(e,l($e,{href:"/kontakt",children:"Kontaktformular"}),S,k),e})(),gameroundUuidError:g(gr),ourMistake:(()=>{var e=g(hr),t=e.firstChild,n=t.nextSibling,[r,i]=m(n.nextSibling);return r.nextSibling,u(e,l($e,{href:"/kontakt",children:"Kontaktformular"}),r,i),e})(),program:(()=>{var e=g(mr),t=e.firstChild,n=t.nextSibling,[r,i]=m(n.nextSibling);return r.nextSibling,u(e,l($e,{href:"/kontakt",children:"Kontaktformular"}),r,i),e})(),help:(()=>{var e=g($r),t=e.firstChild,n=t.nextSibling,[r,i]=m(n.nextSibling);return r.nextSibling,u(e,l($e,{href:"/kontakt",children:"Kontaktformular"}),r,i),e})(),siteNotFound:(()=>{var e=g(fr),t=e.firstChild,n=t.nextSibling,[r,i]=m(n.nextSibling);return r.nextSibling,u(e,l($e,{href:"/kontakt",children:"Kontaktformular"}),r,i),e})(),noAccess:(()=>{var e=g(br),t=e.firstChild,n=t.nextSibling,[r,i]=m(n.nextSibling);return r.nextSibling,u(e,l($e,{href:"/kontakt",children:"Kontaktformular"}),r,i),e})()},vr="Neue Spielrunde erstellen",kr="Neuer Eintrag erstellen",yr="kein Zeitslot ausgewählt",xr="Die Eingabe scheint keine gültige E-Mail-Adresse zu sein.",Dr="Dies ist ein Pflichtfeld.",Er="Dieses Feld ist auf {} Zeichen limitiert.",pr={FRIDAY:"Freitag",SATURDAY:"Samstag",SUNDAY:"Sonntag"},Ar={draft:"Entwurf",published:"Veröffentlicht",archived:"Gelöscht"},C={loading:Sr,error:_r,createNewGameRound:vr,createNewEntry:kr,missingSlot:yr,invalidEmail:xr,mandatoryField:Dr,charLimitBy:Er,days:pr,publishingSteps:Ar};function Qt(){let e=new Set;function t(i){return e.add(i),()=>e.delete(i)}let n=!1;function r(i,a){if(n)return!(n=!1);const s={to:i,options:a,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const o of e)o.listener({...s,from:o.location,retry:c=>{c&&(n=!0),o.navigate(i,{...a,resolve:!1})}});return!s.defaultPrevented}return{subscribe:t,confirm:r}}let ft;function kt(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),ft=window.history.state._depth}kt();function Rr(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function wr(e,t){let n=!1;return()=>{const r=ft;kt();const i=r==null?null:ft-r;if(n){n=!1;return}i&&t(i)?(n=!0,window.history.go(-i)):e()}}const Tr=/^(?:[a-z0-9]+:)?\/\//i,Ur=/^\/+|(\/)\/+$/g,Xt="http://sr";function Re(e,t=!1){const n=e.replace(Ur,"$1");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function qe(e,t,n){if(Tr.test(t))return;const r=Re(e),i=n&&Re(n);let a="";return!i||t.startsWith("/")?a=r:i.toLowerCase().indexOf(r.toLowerCase())!==0?a=r+i:a=i,(a||"/")+Re(t,!a)}function Cr(e,t){if(e==null)throw new Error(t);return e}function Pr(e,t){return Re(e).replace(/\/*(\*.*)?$/g,"")+Re(t)}function en(e){const t={};return e.searchParams.forEach((n,r)=>{r in t?Array.isArray(t[r])?t[r].push(n):t[r]=[t[r],n]:t[r]=n}),t}function Fr(e,t,n){const[r,i]=e.split("/*",2),a=r.split("/").filter(Boolean),s=a.length;return o=>{const c=o.split("/").filter(Boolean),d=c.length-s;if(d<0||d>0&&i===void 0&&!t)return null;const h={path:s?"":"/",params:{}},b=v=>n===void 0?void 0:n[v];for(let v=0;v<s;v++){const S=a[v],k=S[0]===":",f=k?c[v]:c[v].toLowerCase(),_=k?S.slice(1):S.toLowerCase();if(k&&st(f,b(_)))h.params[_]=f;else if(k||!st(f,_))return null;h.path+=`/${f}`}if(i){const v=d?c.slice(-d).join("/"):"";if(st(v,b(i)))h.params[i]=v;else return null}return h}}function st(e,t){const n=r=>r===e;return t===void 0?!0:typeof t=="string"?n(t):typeof t=="function"?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp?t.test(e):!1}function Lr(e){const[t,n]=e.pattern.split("/*",2),r=t.split("/").filter(Boolean);return r.reduce((i,a)=>i+(a.startsWith(":")?2:3),r.length-(n===void 0?0:1))}function tn(e){const t=new Map,n=jt();return new Proxy({},{get(r,i){return t.has(i)||Mt(n,()=>t.set(i,ne(()=>e()[i]))),t.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())},has(r,i){return i in e()}})}function Ir(e,t){const n=new URLSearchParams(e);Object.entries(t).forEach(([i,a])=>{a==null||a===""||a instanceof Array&&!a.length?n.delete(i):a instanceof Array?(n.delete(i),a.forEach(s=>{n.append(i,String(s))})):n.set(i,String(a))});const r=n.toString();return r?`?${r}`:""}function nn(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),r=e.slice(t.index+t[0].length);const i=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(r);)i.push(n+=t[1]),r=r.slice(t[0].length);return nn(r).reduce((a,s)=>[...a,...i.map(o=>o+s)],[])}const Nr=100,rn=Kt(),yt=Kt(),Ke=()=>Cr(bt(rn),"<A> and 'use' router primitives can be only used inside a Route."),Yr=()=>bt(yt)||Ke().base,Or=e=>{const t=Yr();return ne(()=>t.resolvePath(e()))},Hr=e=>{const t=Ke();return ne(()=>{const n=e();return n!==void 0?t.renderPath(n):n})},xt=()=>Ke().navigatorFactory(),ln=()=>Ke().location,an=()=>Ke().params,Br=()=>{const e=ln(),t=xt(),n=(r,i)=>{const a=_t(()=>Ir(e.search,r)+e.hash);t(a,{scroll:!1,resolve:!1,...i})};return[e.query,n]};function zr(e,t=""){const{component:n,preload:r,load:i,children:a,info:s}=e,o=!a||Array.isArray(a)&&!a.length,c={key:e,component:n,preload:r||i,info:s};return sn(e.path).reduce((d,h)=>{for(const b of nn(h)){const v=Pr(t,b);let S=o?v:v.split("/*",1)[0];S=S.split("/").map(k=>k.startsWith(":")||k.startsWith("*")?k:encodeURIComponent(k)).join("/"),d.push({...c,originalPath:h,pattern:S,matcher:Fr(S,!o,e.matchFilters)})}return d},[])}function Mr(e,t=0){return{routes:e,score:Lr(e[e.length-1])*1e4-t,matcher(n){const r=[];for(let i=e.length-1;i>=0;i--){const a=e[i],s=a.matcher(n);if(!s)return null;r.unshift({...s,route:a})}return r}}}function sn(e){return Array.isArray(e)?e:[e]}function un(e,t="",n=[],r=[]){const i=sn(e);for(let a=0,s=i.length;a<s;a++){const o=i[a];if(o&&typeof o=="object"){o.hasOwnProperty("path")||(o.path="");const c=zr(o,t);for(const d of c){n.push(d);const h=Array.isArray(o.children)&&o.children.length===0;if(o.children&&!h)un(o.children,d.pattern,n,r);else{const b=Mr([...n],r.length);r.push(b)}n.pop()}}}return n.length?r:r.sort((a,s)=>s.score-a.score)}function ut(e,t){for(let n=0,r=e.length;n<r;n++){const i=e[n].matcher(t);if(i)return i}return[]}function jr(e,t,n){const r=new URL(Xt),i=ne(h=>{const b=e();try{return new URL(b,r)}catch{return console.error(`Invalid path ${b}`),h}},r,{equals:(h,b)=>h.href===b.href}),a=ne(()=>i().pathname),s=ne(()=>i().search,!0),o=ne(()=>i().hash),c=()=>"",d=St(s,()=>en(i()));return{get pathname(){return a()},get search(){return s()},get hash(){return o()},get state(){return t()},get key(){return c()},query:n?n(d):tn(d)}}let Ee;function Kr(){return Ee}function Wr(e,t,n,r={}){const{signal:[i,a],utils:s={}}=e,o=s.parsePath||(p=>p),c=s.renderPath||(p=>p),d=s.beforeLeave||Qt(),h=qe("",r.base||"");if(h===void 0)throw new Error(`${h} is not a valid base path`);h&&!i().value&&a({value:h,replace:!0,scroll:!1});const[b,v]=ie(!1);let S;const k=(p,A)=>{A.value===f()&&A.state===y()||(S===void 0&&v(!0),Ee=p,S=A,En(()=>{S===A&&(_(S.value),x(S.state),An(),P[1](H=>H.filter(ee=>ee.pending)))}).finally(()=>{S===A&&pn(()=>{Ee=void 0,p==="navigate"&&X(S),v(!1),S=void 0})}))},[f,_]=ie(i().value),[y,x]=ie(i().state),R=jr(f,y,s.queryWrapper),w=[],P=ie([]),L=ne(()=>typeof r.transformUrl=="function"?ut(t(),r.transformUrl(R.pathname)):ut(t(),R.pathname)),O=()=>{const p=L(),A={};for(let H=0;H<p.length;H++)Object.assign(A,p[H].params);return A},M=s.paramsWrapper?s.paramsWrapper(O,t):tn(O),I={pattern:h,path:()=>h,outlet:()=>null,resolvePath(p){return qe(h,p)}};return K(St(i,p=>k("native",p),{defer:!0})),{base:I,location:R,params:M,isRouting:b,renderPath:c,parsePath:o,navigatorFactory:W,matches:L,beforeLeave:d,preloadRoute:Z,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:P};function Q(p,A,H){_t(()=>{if(typeof A=="number"){A&&(s.go?s.go(A):console.warn("Router integration does not support relative routing"));return}const ee=!A||A[0]==="?",{replace:ge,resolve:q,scroll:B,state:te}={replace:!1,resolve:!ee,scroll:!0,...H},N=q?p.resolvePath(A):qe(ee&&R.pathname||"",A);if(N===void 0)throw new Error(`Path '${A}' is not a routable path`);if(w.length>=Nr)throw new Error("Too many redirects");const G=f();(N!==G||te!==y())&&(Dn||d.confirm(N,H)&&(w.push({value:G,replace:ge,scroll:B,state:y()}),k("navigate",{value:N,state:te})))})}function W(p){return p=p||bt(yt)||I,(A,H)=>Q(p,A,H)}function X(p){const A=w[0];A&&(a({...p,replace:A.replace,scroll:A.scroll}),w.length=0)}function Z(p,A){const H=ut(t(),p.pathname),ee=Ee;Ee="preload";for(let ge in H){const{route:q,params:B}=H[ge];q.component&&q.component.preload&&q.component.preload();const{preload:te}=q;A&&te&&Mt(n(),()=>te({params:B,location:{pathname:p.pathname,search:p.search,hash:p.hash,query:en(p),state:null,key:""},intent:"preload"}))}Ee=ee}}function Zr(e,t,n,r){const{base:i,location:a,params:s}=e,{pattern:o,component:c,preload:d}=r().route,h=ne(()=>r().path);c&&c.preload&&c.preload();const b=d?d({params:s,location:a,intent:Ee||"initial"}):void 0;return{parent:t,pattern:o,path:h,outlet:()=>c?l(c,{params:s,location:a,data:b,get children(){return n()}}):n(),resolvePath(S){return qe(i.path(),S,h())}}}const Vr=e=>t=>{const{base:n}=t,r=Rn(()=>t.children),i=ne(()=>un(r(),t.base||""));let a;const s=Wr(e,i,()=>a,{base:n,singleFlight:t.singleFlight,transformUrl:t.transformUrl});return e.create&&e.create(s),l(rn.Provider,{value:s,get children(){return l(qr,{routerState:s,get root(){return t.root},get preload(){return t.rootPreload||t.rootLoad},get children(){return[z(()=>(a=jt())&&null),l(Jr,{routerState:s,get branches(){return i()}})]}})}})};function qr(e){const t=e.routerState.location,n=e.routerState.params,r=ne(()=>e.preload&&_t(()=>{e.preload({params:n,location:t,intent:Kr()||"initial"})}));return l(D,{get when(){return e.root},keyed:!0,get fallback(){return e.children},children:i=>l(i,{params:n,location:t,get data(){return r()},get children(){return e.children}})})}function Jr(e){const t=[];let n;const r=ne(St(e.routerState.matches,(i,a,s)=>{let o=a&&i.length===a.length;const c=[];for(let d=0,h=i.length;d<h;d++){const b=a&&a[d],v=i[d];s&&b&&v.route.key===b.route.key?c[d]=s[d]:(o=!1,t[d]&&t[d](),wn(S=>{t[d]=S,c[d]=Zr(e.routerState,c[d-1]||e.routerState.base,Ut(()=>r()[d+1]),()=>{const k=e.routerState.matches();return k[d]??k[0]})}))}return t.splice(i.length).forEach(d=>d()),s&&o?s:(n=c[0],c)}));return Ut(()=>r()&&n)()}const Ut=e=>()=>l(D,{get when(){return e()},keyed:!0,children:t=>l(yt.Provider,{value:t,get children(){return t.outlet()}})});function Gr([e,t],n,r){return[e,r?i=>t(r(i)):t]}function Qr(e){let t=!1;const n=i=>typeof i=="string"?{value:i}:i,r=Gr(ie(n(e.get()),{equals:(i,a)=>i.value===a.value&&i.state===a.state}),void 0,i=>(!t&&e.set(i),it.registry&&!it.done&&(it.done=!0),i));return e.init&&Wt(e.init((i=e.get())=>{t=!0,r[1](n(i)),t=!1})),Vr({signal:r,create:e.create,utils:e.utils})}function Xr(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function ei(e,t){const n=e&&document.getElementById(e);n?n.scrollIntoView():t&&window.scrollTo(0,0)}const ti=new Map;function ni(e=!0,t=!1,n="/_server",r){return i=>{const a=i.base.path(),s=i.navigatorFactory(i.base);let o,c;function d(f){return f.namespaceURI==="http://www.w3.org/2000/svg"}function h(f){if(f.defaultPrevented||f.button!==0||f.metaKey||f.altKey||f.ctrlKey||f.shiftKey)return;const _=f.composedPath().find(L=>L instanceof Node&&L.nodeName.toUpperCase()==="A");if(!_||t&&!_.hasAttribute("link"))return;const y=d(_),x=y?_.href.baseVal:_.href;if((y?_.target.baseVal:_.target)||!x&&!_.hasAttribute("state"))return;const w=(_.getAttribute("rel")||"").split(/\s+/);if(_.hasAttribute("download")||w&&w.includes("external"))return;const P=y?new URL(x,document.baseURI):new URL(x);if(!(P.origin!==window.location.origin||a&&P.pathname&&!P.pathname.toLowerCase().startsWith(a.toLowerCase())))return[_,P]}function b(f){const _=h(f);if(!_)return;const[y,x]=_,R=i.parsePath(x.pathname+x.search+x.hash),w=y.getAttribute("state");f.preventDefault(),s(R,{resolve:!1,replace:y.hasAttribute("replace"),scroll:!y.hasAttribute("noscroll"),state:w?JSON.parse(w):void 0})}function v(f){const _=h(f);if(!_)return;const[y,x]=_;i.preloadRoute(x,y.getAttribute("preload")!=="false")}function S(f){clearTimeout(o);const _=h(f);if(!_)return c=null;const[y,x]=_;c!==y&&(o=setTimeout(()=>{i.preloadRoute(x,y.getAttribute("preload")!=="false"),c=y},20))}function k(f){if(f.defaultPrevented)return;let _=f.submitter&&f.submitter.hasAttribute("formaction")?f.submitter.getAttribute("formaction"):f.target.getAttribute("action");if(!_)return;if(!_.startsWith("https://action/")){const x=new URL(_,Xt);if(_=i.parsePath(x.pathname+x.search),!_.startsWith(n))return}if(f.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const y=ti.get(_);if(y){f.preventDefault();const x=new FormData(f.target,f.submitter);y.call({r:i,f:f.target},f.target.enctype==="multipart/form-data"?x:new URLSearchParams(x))}}vt(["click","submit"]),document.addEventListener("click",b),e&&(document.addEventListener("mousemove",S,{passive:!0}),document.addEventListener("focusin",v,{passive:!0}),document.addEventListener("touchstart",v,{passive:!0})),document.addEventListener("submit",k),Wt(()=>{document.removeEventListener("click",b),e&&(document.removeEventListener("mousemove",S),document.removeEventListener("focusin",v),document.removeEventListener("touchstart",v)),document.removeEventListener("submit",k)})}}function ri(e){const t=e.replace(/^.*?#/,"");if(!t.startsWith("/")){const[,n="/"]=window.location.hash.split("#",2);return`${n}#${t}`}return t}function ii(e){const t=()=>window.location.hash.slice(1),n=Qt();return Qr({get:t,set({value:r,replace:i,scroll:a,state:s}){i?window.history.replaceState(Rr(s),"","#"+r):window.history.pushState(s,"","#"+r);const o=r.indexOf("#"),c=o>=0?r.slice(o+1):"";ei(c,a),kt()},init:r=>Xr(window,"hashchange",wr(r,i=>!n.confirm(i&&i<0?i:t()))),create:ni(e.preload,e.explicitLinks,e.actionBase),utils:{go:r=>window.history.go(r),renderPath:r=>`#${r}`,parsePath:ri,beforeLeave:n}})(e)}var li=$("<a>");function V(e){e=wt({inactiveClass:"inactive",activeClass:"active"},e);const[,t]=Tn(e,["href","state","class","activeClass","inactiveClass","end"]),n=Or(()=>e.href),r=Hr(n),i=ln(),a=ne(()=>{const s=n();if(s===void 0)return[!1,!1];const o=Re(s.split(/[?#]/,1)[0]).toLowerCase(),c=decodeURI(Re(i.pathname).toLowerCase());return[e.end?o===c:c.startsWith(o+"/")||c===o,o===c]});return(()=>{var s=g(li);return Un(s,wt(t,{get href(){return r()||e.href},get state(){return JSON.stringify(e.state)},get classList(){return{...e.class&&{[e.class]:!0},[e.inactiveClass]:!a()[0],[e.activeClass]:a()[0],...t.classList}},link:"",get"aria-current"(){return a()[1]?"page":void 0}}),!1,!1),Qe(),s})()}var ai=$("<div class=grid><!$><!/><div>"),si=$("<div class=boxLink>");function _e(e){const t=e.type??"special";return(()=>{var n=g(si);return u(n,l(E,{type:t,get onClick(){return e.onClick},get children(){var r=g(ai),i=r.firstChild,[a,s]=m(i.nextSibling),o=a.nextSibling;return u(r,l(ue,{get icon(){return e.icon}}),a,s),u(o,()=>e.children),r}})),n})()}var ui=$("<h3>Programm ansehen"),oi=$("<p>Melde dich (und deine Freunde) für diverse Spielrunden an."),Ct=$("<br>"),ci=$("<h3>Programmpunkte erstellen"),di=$("<p>Erstelle und editiere Programmpunkte."),gi=$("<h3>Helfen"),hi=$("<p>Beim Kiosk und der Essensausgabe können wir immer ein paar helfende Hände gebrauchen."),mi=$("<h3>Zusammenfassung"),$i=$("<p>Erhalte einen Überblick über dein gesamtes Programm."),fi=$("<div><!$><!/><!$><!/><br><!$><!/>");function bi(e){return(()=>{var t=g(fi),n=t.firstChild,[r,i]=m(n.nextSibling),a=r.nextSibling,[s,o]=m(a.nextSibling),c=s.nextSibling,d=c.nextSibling,[h,b]=m(d.nextSibling);return u(t,l(D,{get when(){return e.roles.includes("admin")},get children(){return[l(V,{get href(){return e.link("/programm")},class:"button-link",get children(){return l(_e,{icon:"dice-d20",get children(){return[g(ui),g(oi)]}})}}),g(Ct),l(V,{get href(){return e.link("/erstellen")},class:"button-link",get children(){return l(_e,{icon:"grid-2-plus",get children(){return[g(ci),g(di)]}})}}),g(Ct)]}}),r,i),u(t,l(V,{get href(){return e.link("/helfen")},class:"button-link",get children(){return l(_e,{icon:"hand-heart",get children(){return[g(gi),g(hi)]}})}}),s,o),u(t,l(V,{get href(){return e.link("/zusammenfassung")},class:"button-link",get children(){return l(_e,{icon:"list",get children(){return[g(mi),g($i)]}})}}),h,b),t})()}var Si=$("<a class=header-anchor>");function _i(e){return encodeURIComponent(e.replaceAll(/\s/g,"-").replaceAll("&","").replaceAll(/-{1,}/g,"-").toLocaleLowerCase())}function We(e){const t=_i("title"in e?e.id??e.title:e.id);return l(Cn,{get component(){return`h${e.level}`},id:t,get children(){var n=g(Si);return ye(n,"href",`#${t}`),u(n,(()=>{var r=z(()=>"title"in e);return()=>r()?e.title:e.children})()),n}})}var vi=$("<div style=display:grid;gap:1rem><!$><!/><!$><!/><!$><!/>"),ki=$("<div><div style=margin-block-end:1.5rem></div><!$><!/>"),yi=$("<p>Konflikte gefunden! Bitte stelle sicher, dass du nicht zeitlich überlappende Spielrunden eingetragen hast:"),xi=$('<div style="display:grid;grid-template-columns:1fr max-content 1fr;gap:1rem;margin-block:0.5rem"><!$><!/><span style=color:var(--clr-warning-10);align-self:center;font-size:2rem></span><!$><!/>'),Di=$("<div><!$><!/><div class=entries></div><div class=after-hour><div class=annotation>"),Ei=$("<div><div class=annotation></div><div class=background>"),pi=$("<div class=entry>");function on(e){const t=e.exclude??[];return(()=>{var n=g(vi),r=n.firstChild,[i,a]=m(r.nextSibling),s=i.nextSibling,[o,c]=m(s.nextSibling),d=o.nextSibling,[h,b]=m(d.nextSibling);return u(n,l(D,{get when(){return z(()=>!t.includes("FRIDAY")&&e.openingHours.FRIDAY.open.from!==e.openingHours.FRIDAY.open.to)()&&(e.dayFilter===null||e.dayFilter==="FRIDAY")},get children(){return l(ot,{get programEntries(){return e.programEntries.FRIDAY},get openingHoursOfDay(){return e.openingHours.FRIDAY},day:"FRIDAY",get conflictsAllowed(){return e.conflictsAllowed??!1},get columns(){return e.columns}})}}),i,a),u(n,l(D,{get when(){return z(()=>!t.includes("SATURDAY"))()&&e.dayFilter===null||e.dayFilter==="SATURDAY"},get children(){return l(ot,{get programEntries(){return e.programEntries.SATURDAY},get openingHoursOfDay(){return e.openingHours.SATURDAY},day:"SATURDAY",get conflictsAllowed(){return e.conflictsAllowed??!1},get columns(){return e.columns}})}}),o,c),u(n,l(D,{get when(){return z(()=>!t.includes("SUNDAY"))()&&e.dayFilter===null||e.dayFilter==="SUNDAY"},get children(){return l(ot,{get programEntries(){return e.programEntries.SUNDAY},get openingHoursOfDay(){return e.openingHours.SUNDAY},day:"SUNDAY",get conflictsAllowed(){return e.conflictsAllowed??!1},get columns(){return e.columns}})}}),h,b),n})()}function ot(e){const t=e.conflictsAllowed?[]:Ri(e.programEntries);return(()=>{var n=g(ki),r=n.firstChild,i=r.nextSibling,[a,s]=m(i.nextSibling);return u(r,l(We,{level:4,get title(){return C.days[e.day]}})),u(n,l(Me,{get fallback(){return[l(E,{type:"danger",get children(){return g(yi)}}),l(J,{each:t,children:([o,c])=>(()=>{var d=g(xi),h=d.firstChild,[b,v]=m(h.nextSibling),S=b.nextSibling,k=S.nextSibling,[f,_]=m(k.nextSibling);return u(d,()=>o.component(),b,v),u(S,l(ue,{icon:"triangle-exclamation"})),u(d,()=>c.component(),f,_),d})()})]},get children(){return l(he,{get when(){return t.length===0},get children(){return l(Ai,{get programEntries(){return e.programEntries},get openingHoursOfDay(){return e.openingHoursOfDay},get day(){return e.day},get conflictsAllowed(){return e.conflictsAllowed},get columns(){return e.columns}})}})}}),a,s),n})()}function Ai(e){const t=Zn(e.openingHoursOfDay.open),n=e.openingHoursOfDay.breaks.flatMap(({from:s,to:o})=>{me(s<o,`Break is not valid, as from '${s}' is not smaller than to '${o}'`);const c=[s];let d=o-s;for(;d>1;)c.push(s+--d);return c}),r=(t[0]??0)-1,i=t.at(-1)??0,a=()=>{const s=["timetable"];return e.conflictsAllowed&&s.push(e.columns===2?"two-columns":e.columns===4?"four-columns":""),s.join(" ")};return(()=>{var s=g(Di),o=s.firstChild,[c,d]=m(o.nextSibling),h=c.nextSibling,b=h.nextSibling,v=b.firstChild;return u(s,l(J,{each:t,children:S=>{const k=n.includes(S);return(()=>{var f=g(Ei),_=f.firstChild;return xe(f,`hour ${k?"break":""}`),u(_,S),K(y=>lt(f,Pt({startTime:ce.PlainTime.from({hour:S,minute:0}),endTime:ce.PlainTime.from({hour:S,minute:0})},r,e.day,e.openingHoursOfDay),y)),f})()}}),c,d),u(h,l(J,{get each(){return e.programEntries},children:S=>(()=>{var k=g(pi);return u(k,()=>S.component()),K(f=>lt(k,Pt(S.range,r,e.day,e.openingHoursOfDay),f)),k})()})),u(v,i+1),K(S=>{var k=a(),f=`grid-row: 1 / ${i-r+1};`;return k!==S.e&&xe(s,S.e=k),S.t=lt(h,f,S.t),S},{e:void 0,t:void 0}),s})()}function Pt(e,t,n,r){const{startTime:i,endTime:a}=e,s=i.hour-t,o=a.hour===0?24-t:a.hour-t,c=r.open.to;return me(s>0,`[${JSON.stringify(e)}] Entry can't start at '${i.hour}'.`),me(o>0,`[${JSON.stringify(e)}] Entry can't end at '${a.hour}'.`),me(a.hour<=c,`[${JSON.stringify(e)}] Entry can't end at '${a.hour}'. Closing hour set to '${c}' on day '${n}'`),`grid-row: ${s} / ${o};`}function Ri(e){const t=[];return e.forEach((n,r)=>{e.slice(r+1).forEach(i=>{Wn(n.range,i.range)&&t.push([n,i])})}),t}const ke=ce.PlainDate.from({year:2026,month:3,day:13}),Y=ce.PlainDate.from({year:2026,month:3,day:14}),j=ce.PlainDate.from({year:2026,month:3,day:15}),tt={FRIDAY:ke,SATURDAY:Y,SUNDAY:j};function we(e){const{year:t,month:n,day:r}=e;return ke.year===t&&ke.month===n&&ke.day===r?"FRIDAY":Y.year===t&&Y.month===n&&Y.day===r?"SATURDAY":j.year===t&&j.month===n&&j.day===r?"SUNDAY":null}const cn={FRIDAY:{open:{from:0,to:0},breaks:[]},SATURDAY:{open:{from:10,to:24},breaks:[]},SUNDAY:{open:{from:10,to:18},breaks:[]}},pe={kitchen:{title:"Küche",description:"Mahlzeit vorbereiten, unterstützen beim Kochen und Abwaschen."},service:{title:"Essensausgabe",description:""},cleaning:{title:"Reinigung",description:"Unterstützen beim Küche aufräumen und putzen."},kiosk:{title:"Kiosk",description:"Am Kiosk Getränke (inkl. Kaffee) und Snacks verkaufen."},flohmarkt:{title:"Flohmarkt",description:"Hilf uns beim Auf- oder Abbau des Flohmarkt und der Annahme oder Abgabe von Spielen."},checkout:{title:"Kiosk oder Flohmarkt",description:"Am Kiosk Getränke und Snacks verkaufen oder am Flohmarkt die Kasse bedienen."},setup:{title:"Menü-Vorbereitung / Aufbau",description:"Hilf uns beim Zubereiten der Menüs und Aufstellen von Tischen, Stühle und der Bibliothek."},breakdown:{title:"Abbau",description:"Hilf uns beim Zusammenräumen von Tischen, Stühle, der Bibliothek und dem Flohmarkt."}},Te=[{uuid:"eb443040-0674-429c-a3ad-48634a323b76",count:4,kind:"setup",dateTime:{startDate:ke.toPlainDateTime({hour:16,minute:0}),endDate:ke.toPlainDateTime({hour:21,minute:0})}},{uuid:"91699a72-78d0-4dc9-bfe1-ece55b15db7d",count:1,kind:"flohmarkt",dateTime:{startDate:ke.toPlainDateTime({hour:19,minute:0}),endDate:ke.toPlainDateTime({hour:22,minute:0})}},{uuid:"9ebca7e9-f44a-4cc9-8961-73539f17d5d6",count:2,kind:"checkout",dateTime:{startDate:Y.toPlainDateTime({hour:10,minute:0}),endDate:Y.toPlainDateTime({hour:12,minute:0})}},{uuid:"6303bd52-cd10-4dd0-b760-b71ab971ad3b",count:4,kind:"flohmarkt",dateTime:{startDate:Y.toPlainDateTime({hour:9,minute:0}),endDate:Y.toPlainDateTime({hour:11,minute:0})}},{uuid:"804c379d-c747-4d7c-9f0c-a53f8548216e",count:1,kind:"kitchen",dateTime:{startDate:Y.toPlainDateTime({hour:11,minute:0}),endDate:Y.toPlainDateTime({hour:13,minute:0})}},{uuid:"bfec6f59-14eb-45b9-a21c-d33ee2205b64",count:2,kind:"checkout",dateTime:{startDate:Y.toPlainDateTime({hour:12,minute:0}),endDate:Y.toPlainDateTime({hour:14,minute:0})}},{uuid:"8db23dfd-616e-4f1d-9a07-deb6e519d35a",count:1,kind:"kitchen",dateTime:{startDate:Y.toPlainDateTime({hour:13,minute:0}),endDate:Y.toPlainDateTime({hour:15,minute:0})}},{uuid:"477a1c27-b660-4221-9be0-de34de910f4b",count:2,kind:"checkout",dateTime:{startDate:Y.toPlainDateTime({hour:14,minute:0}),endDate:Y.toPlainDateTime({hour:16,minute:0})}},{uuid:"490c799f-ced5-461e-a483-ad6a90df221b",count:2,kind:"checkout",dateTime:{startDate:Y.toPlainDateTime({hour:16,minute:0}),endDate:Y.toPlainDateTime({hour:18,minute:0})}},{uuid:"c9f79536-225a-41ee-93e6-ef1741b511f7",count:1,kind:"kitchen",dateTime:{startDate:Y.toPlainDateTime({hour:17,minute:0}),endDate:Y.toPlainDateTime({hour:19,minute:0})}},{uuid:"c6c3f0f7-04c6-4819-95e6-aa8476e4392c",count:2,kind:"checkout",dateTime:{startDate:Y.toPlainDateTime({hour:18,minute:0}),endDate:Y.toPlainDateTime({hour:20,minute:0})}},{uuid:"9748b1e6-1712-449b-8dda-eb44f172071e",count:1,kind:"kitchen",dateTime:{startDate:Y.toPlainDateTime({hour:19,minute:0}),endDate:Y.toPlainDateTime({hour:21,minute:0})}},{uuid:"e1a9b252-628c-4c01-b8e1-e1964b51e646",count:2,kind:"checkout",dateTime:{startDate:j.toPlainDateTime({hour:10,minute:0}),endDate:j.toPlainDateTime({hour:12,minute:0})}},{uuid:"873a1308-57bc-46bc-bdfc-a82213364c77",count:1,kind:"kitchen",dateTime:{startDate:j.toPlainDateTime({hour:11,minute:0}),endDate:j.toPlainDateTime({hour:13,minute:0})}},{uuid:"2e9864a9-0208-4e56-b232-dcd258e31545",count:2,kind:"checkout",dateTime:{startDate:j.toPlainDateTime({hour:12,minute:0}),endDate:j.toPlainDateTime({hour:14,minute:0})}},{uuid:"caef5fea-8458-4b65-b699-9c4e5ee6589d",count:1,kind:"kitchen",dateTime:{startDate:j.toPlainDateTime({hour:13,minute:0}),endDate:j.toPlainDateTime({hour:15,minute:0})}},{uuid:"0da24180-0269-4206-adf7-4b9faeefa091",count:2,kind:"checkout",dateTime:{startDate:j.toPlainDateTime({hour:14,minute:0}),endDate:j.toPlainDateTime({hour:16,minute:0})}},{uuid:"40eaef18-d6a0-46e8-b3e5-a98be09cef57",count:2,kind:"checkout",dateTime:{startDate:j.toPlainDateTime({hour:16,minute:0}),endDate:j.toPlainDateTime({hour:18,minute:0})}},{uuid:"b9da7047-c359-49fa-b558-53207ac5255a",count:2,kind:"flohmarkt",dateTime:{startDate:j.toPlainDateTime({hour:17,minute:0}),endDate:j.toPlainDateTime({hour:19,minute:0})}},{uuid:"c0e1d54c-0832-4147-9054-082208dab2f2",count:4,kind:"breakdown",dateTime:{startDate:j.toPlainDateTime({hour:17,minute:0}),endDate:j.toPlainDateTime({hour:20,minute:0})}}],wi=Te.map(e=>e.uuid),Ft=Object.entries(Object.groupBy(wi,e=>e)).reduce((e,[t,n])=>[...e,{uuid:t,count:n?.length??0}],[]).filter(({count:e})=>e!==1);if(Ft.length>0)throw Error(`duplicate uuids found:  ${Ft.map(({uuid:e})=>e).join(", ")}`);function Ti(e){return Te.find(t=>t.uuid===e)??null}const Je={FRIDAY:{open:{from:16,to:22},breaks:[{from:16,to:22}]},SATURDAY:{open:{from:9,to:24},breaks:[{from:9,to:10}]},SUNDAY:{open:{from:10,to:20},breaks:[{from:18,to:20}]}};var Ui=$("<span>");function He(e){const t=()=>{const n=["chip"];return n.push(e.kind??"gray"),e.inverted&&n.push("inverted"),e.size==="small"&&n.push("small"),n.join(" ")};return(()=>{var n=g(Ui);return u(n,()=>e.children),K(r=>{var i=t(),a=e.title;return i!==r.e&&xe(n,r.e=i),a!==r.t&&ye(n,"title",r.t=a),r},{e:void 0,t:void 0}),n})()}const Ci=F({start:U(),end:U()}).transform((e,t)=>{const{start:n,end:r}=e,i=pt(n),a=pt(r);return i.kind==="ERROR"?(t.addIssue({code:"custom",message:i.message}),At):a.kind==="ERROR"?(t.addIssue({code:"custom",message:a.message}),At):{startDate:ce.PlainDateTime.from({year:i.value.year,month:i.value.month,day:i.value.day,hour:i.value.hour,minute:i.value.minute}),endDate:ce.PlainDateTime.from({year:a.value.year,month:a.value.month,day:a.value.day,hour:a.value.hour,minute:a.value.minute})}}),Pi=F({uuid:U(),title:U(),organizer:U(),timeSlot:Ci,shortDescription:U(),longDescription:U(),participating:ze([F({kind:le("NONE"),maxSeats:de()}),F({kind:le("LIMITED"),maxSeats:de()})]),tagNames:U()}),Fi=_n(U(),de()),Li=F({programEntries:Ae(Pi),reservations:Fi});async function Ii(){const e=await Hn();if(e.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const t=Li.safeParse(e.data);return t.success?{kind:"SUCCESS",data:t.data}:{kind:"FAILURE"}}var Ni=$("<div style=display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between><h5 style=margin:0>Filter"),Yi=$("<div style=display:flex;flex-wrap:wrap;gap:0.5rem><!$><!/><!$><!/><!$><!/><!$><!/>");function dn(e){const t=e.exclude??[];return l(E,{get children(){return[g(Ni),(()=>{var n=g(Yi),r=n.firstChild,[i,a]=m(r.nextSibling),s=i.nextSibling,[o,c]=m(s.nextSibling),d=o.nextSibling,[h,b]=m(d.nextSibling),v=h.nextSibling,[S,k]=m(v.nextSibling);return u(n,l(oe,{label:"Alle Tage",get kind(){return e.dayFilter()===null?"success":"gray"},onClick:()=>e.setDayFilter(null)}),i,a),u(n,l(D,{get when(){return!t.includes("FRIDAY")},get children(){return l(oe,{label:"Freitag",get kind(){return e.dayFilter()==="FRIDAY"?"success":"gray"},onClick:()=>e.setDayFilter("FRIDAY")})}}),o,c),u(n,l(D,{get when(){return!t.includes("SATURDAY")},get children(){return l(oe,{label:"Samstag",get kind(){return e.dayFilter()==="SATURDAY"?"success":"gray"},onClick:()=>e.setDayFilter("SATURDAY")})}}),h,b),u(n,l(D,{get when(){return!t.includes("SUNDAY")},get children(){return l(oe,{label:"Sonntag",get kind(){return e.dayFilter()==="SUNDAY"?"success":"gray"},onClick:()=>e.setDayFilter("SUNDAY")})}}),S,k),n})()]}})}var Oi=$("<p>Beim Kiosk und der Essensausgabe können wir immer ein paar helfende Hände gebrauchen. Wenn du bereit bist zu helfen, klicke in der jeweiligen Stunde auf das Handsymbol <!$><!/>."),Ie=$("<br>"),Hi=$("<h4>Zur Anmeldung für Erklärbären"),Bi=$("<div class=dynamic-columns><p>Eines der Hauptziele der Luzerner Spieltage ist es, dass die Besucher/-innen noch nicht gespielte Spiele ausprobieren können. Dazu unterstützen uns jedes Jahr Freiwillige und erklären die ihnen bekannten Spiele aus der Spiele-Bibliothek. Diese Erklärbären sind durch ihr rotes T-Shirt erkennbar.</p><!$><!/>"),zi=$("<p>Plan konnte nicht geladen werden."),Mi=$("<div><!$><!/><!$><!/><h5></h5><p class=duration><em><!$><!/> / <!$><!/>"),ji=$("<div><!$><!/><!$><!/><h5></h5><p class=duration><span><!$><!/>-<!$><!/>&nbsp;Uhr | </span><em><!$><!/>&nbsp;/&nbsp;<!$><!/>");function Ki(e){const[t,n]=ie(null);return[(()=>{var r=g(Oi),i=r.firstChild,a=i.nextSibling,[s,o]=m(a.nextSibling);return s.nextSibling,u(r,l(ue,{icon:"hand-heart"}),s,o),r})(),g(Ie),l(E,{type:"special",get children(){return["Melde bitte 15 Minuten vor Schichtbeginn bei einem OK-Mitglied, beim"," ",l($e,{href:"/adresse",children:"Eingang zum Würzenbachsaal."})]}}),g(Ie),l(We,{level:3,title:"Erklärbären"}),g(Ie),(()=>{var r=g(Bi),i=r.firstChild,a=i.nextSibling,[s,o]=m(a.nextSibling);return u(r,l(V,{get href(){return e.link("/erklaerbaer")},class:"button-link",style:"margin-block-end: 1rem; padding: 0;",get children(){return l(_e,{icon:"forward",type:"success",get children(){return g(Hi)}})}}),s,o),r})(),g(Ie),l(dn,{dayFilter:t,setDayFilter:n}),g(Ie),l(je,{get fallback(){return l(E,{get children(){return C.loading.program}})},get children(){return l(D,{get when(){return e.publicResource()},get fallback(){return l(E,{type:"danger",get children(){return C.error.help}})},children:r=>l(D,{get when(){return r().kind==="SUCCESS"},get fallback(){return l(E,{type:"danger",get children(){return g(zi)}})},get children(){return l(Wi,{get myHelpReservations(){return e.reservations$.get()},get allReservations(){return r().data.reservations},get isEditable(){return e.isEditable},get link(){return e.link},get dayFilter(){return t()}})}})})}})]}function Wi(e){const t=()=>Object.keys(e.allReservations),n=()=>({FRIDAY:ct({day:"FRIDAY",entries:Te,alreadyReservedUuids:t(),myReservations:e.myHelpReservations,link:e.link}),SATURDAY:ct({day:"SATURDAY",entries:Te,alreadyReservedUuids:t(),myReservations:e.myHelpReservations,link:e.link}),SUNDAY:ct({day:"SUNDAY",entries:Te,alreadyReservedUuids:t(),myReservations:e.myHelpReservations,link:e.link})});return l(on,{get programEntries(){return n()},openingHours:Je,conflictsAllowed:!0,columns:4,get dayFilter(){return e.dayFilter}})}function ct(e){const t=xt(),n=[],r=Zi(e.alreadyReservedUuids);return Object.groupBy(e.entries,a=>we(a.dateTime.startDate)??"empty")[e.day]?.forEach(a=>{const s=()=>a.count-(r[a.uuid]??0),o=()=>e.myReservations.filter(h=>"helpEntryUuid"in h&&h.helpEntryUuid===a.uuid).length>0,c=()=>{const h=["box-simple","timeview-entry"];return o()&&h.push("success"),h.join(" ")},d={startTime:ce.PlainTime.from({hour:a.dateTime.startDate.hour,minute:a.dateTime.startDate.minute}),endTime:a.dateTime.startDate.day!==a.dateTime.endDate.day?ce.PlainTime.from({hour:a.dateTime.endDate.hour,minute:a.dateTime.endDate.minute}):ce.PlainTime.from({hour:a.dateTime.endDate.hour,minute:a.dateTime.endDate.minute})};s()===0?n.push({range:d,component:()=>(()=>{var h=g(Mi),b=h.firstChild,[v,S]=m(b.nextSibling),k=v.nextSibling,[f,_]=m(k.nextSibling),y=f.nextSibling,x=y.nextSibling,R=x.firstChild,w=R.firstChild,[P,L]=m(w.nextSibling),O=P.nextSibling,M=O.nextSibling,[I,Q]=m(M.nextSibling);return h.$$click=()=>t(e.link(`/helfen/${a.uuid}`)),u(h,l(He,{title:"Helfer:innen gesucht",get inverted(){return o()},size:"small",children:"HL"}),v,S),u(h,l(D,{get when(){return o()},get children(){return l(Ue,{icon:"hand-heart",kind:"ghost",onClick:()=>t(e.link(`/helfen/${a.uuid}`)),title:"Helfen"})}}),f,_),u(y,()=>pe[a.kind].title),u(R,s,P,L),u(R,()=>a.count,I,Q),K(W=>{var X=c(),Z=pe[a.kind].title;return X!==W.e&&xe(h,W.e=X),Z!==W.t&&ye(y,"title",W.t=Z),W},{e:void 0,t:void 0}),Qe(),h})()}):n.push({range:d,component:()=>(()=>{var h=g(ji),b=h.firstChild,[v,S]=m(b.nextSibling),k=v.nextSibling,[f,_]=m(k.nextSibling),y=f.nextSibling,x=y.nextSibling,R=x.firstChild,w=R.firstChild,[P,L]=m(w.nextSibling),O=P.nextSibling,M=O.nextSibling,[I,Q]=m(M.nextSibling);I.nextSibling;var W=R.nextSibling,X=W.firstChild,[Z,p]=m(X.nextSibling),A=Z.nextSibling,H=A.nextSibling,[ee,ge]=m(H.nextSibling);return h.$$click=()=>t(e.link(`/helfen/${a.uuid}`)),u(h,l(He,{title:"Helfer:innen gesucht",get inverted(){return o()},size:"small",children:"HL"}),v,S),u(h,l(Ue,{icon:"hand-heart",kind:"ghost",onClick:()=>t(e.link(`/helfen/${a.uuid}`)),title:"Helfen"}),f,_),u(y,()=>pe[a.kind].title),u(R,()=>d.startTime.hour,P,L),u(R,()=>d.endTime.hour,I,Q),u(W,()=>a.count-s(),Z,p),u(W,()=>a.count,ee,ge),K(q=>{var B=c(),te=pe[a.kind].title;return B!==q.e&&xe(h,q.e=B),te!==q.t&&ye(y,"title",q.t=te),q},{e:void 0,t:void 0}),Qe(),h})()})}),n}function Zi(e){const t=Object.groupBy(e,r=>r),n={};for(const r of e)n[r]=t[r]?.length??0;return n}vt(["click"]);var Vi=$("<dialog closedby=any><!$><!/><!$><!/><!$><!/>"),qi=$("<h4>");function Ji(e=!1){return{open:e}}function Gi(e){let t;const[n,r]=ve(e.store);Pn(()=>{n.open?t.showModal():t.close()});function i(){r({open:!1}),e.onClose?.()}const a=()=>{const s=[];return e.type!==void 0&&s.push(e.type),e.size!==void 0&&s.push(e.size),e.onClose!==void 0&&s.push("dialog-with-close"),s};return(()=>{var s=g(Vi),o=s.firstChild,[c,d]=m(o.nextSibling),h=c.nextSibling,[b,v]=m(h.nextSibling),S=b.nextSibling,[k,f]=m(S.nextSibling);s.addEventListener("close",i);var _=t;return typeof _=="function"?Fn(_,s):t=s,u(s,l(D,{get when(){return e.onClose},get children(){return l(Ue,{onClick:i,icon:"circle-xmark",kind:"gray"})}}),c,d),u(s,l(D,{get when(){return e.title},children:y=>(()=>{var x=g(qi);return u(x,y),x})()}),b,v),u(s,()=>e.children,k,f),K(()=>xe(s,a().join(" "))),s})()}var Qi=$("<p>");function dt(e){const[t,n]=ve(e.store),r=e.showErrors==="ALWAYS",i=()=>r||t.isDirty?e.errors??[]:[];return[l(zt,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:a=>{n("value",a),e.onUpdate?.()},onBlur:()=>n("isDirty",!0),get type(){return e.type},get required(){return e.required},get isHoneypot(){return e.isHoneypot},get disabled(){return e.disabled}}),l(D,{get when(){return i().length>0},get children(){return l(E,{type:"danger",get children(){return l(J,{get each(){return i()},children:a=>(()=>{var s=g(Qi);return u(s,a),s})()})}})}})]}U().transform(e=>({value:e,isDirty:!1}));function gt(e){return{value:e,isDirty:!1}}de().transform(e=>({value:e,isDirty:!1}));var Xi=$("<div><!$><!/><br><!$><!/><br><!$><!/>"),el=$("<h5>"),tl=$("<p class=duration>von <!$><!/> bis <!$><!/> Uhr <em><small>(<!$><!/>)"),nl=$("<div>");function rl(e){const[t,n]=ie(null),r=il(e.save,e.publicState,e.link),i=al(r),a=sl(r);return(()=>{var s=g(Xi),o=s.firstChild,[c,d]=m(o.nextSibling),h=c.nextSibling,b=h.nextSibling,[v,S]=m(b.nextSibling),k=v.nextSibling,f=k.nextSibling,[_,y]=m(f.nextSibling);return u(s,l(We,{level:3,title:"Mein Programm"}),c,d),u(s,l(dn,{dayFilter:t,setDayFilter:n,exclude:i}),v,S),u(s,l(on,{get dayFilter(){return t()},programEntries:r,openingHours:a,conflictsAllowed:!1,columns:1,exclude:i}),_,y),s})()}function il(e,t,n){const{helping:r}=e,i={FRIDAY:[],SATURDAY:[],SUNDAY:[]},a=r.map(o=>{if(o.kind==="ERKLAERBAER"){const d={startDate:tt[o.slot.day].toPlainDateTime({hour:o.slot.from,minute:0}),endDate:tt[o.slot.day].toPlainDateTime({hour:o.slot.to,minute:0})};return{...o,meta:{dateTime:d}}}const c=Te.find(d=>d.uuid===o.helpEntryUuid);return me(c!==void 0,`Help UUID is invalid: '${o.helpEntryUuid}'`),{...o,meta:c}}),s=Object.groupBy(a,o=>{const{startDate:c,endDate:d}=o.meta.dateTime;return`${c.year}-${c.month}-${c.day}-${c.hour}-${c.minute}--${d.year}-${d.month}-${d.day}-${d.hour}-${d.minute}`});return Object.values(s).forEach(o=>{if(o===void 0)return;const c=o[0];if(c===void 0)return;let d=!0;const h=o.map(f=>f.kind==="ERKLAERBAER"?["Erklärbär","ME"]:f.kind==="SELF"?[pe[f.meta.kind].title,"ME"]:(d=!1,[pe[f.meta.kind].title,f.name])),b=d?h.map(([f])=>f).join(", "):h.map(([f,_])=>_==="ME"?f:`${f} (${_})`).join("; "),v=we(c.meta.dateTime.startDate);me(v!==null,`Date '${JSON.stringify(c.meta.dateTime.startDate)}' is not a valid event date.`);const S={startTime:c.meta.dateTime.startDate.toPlainTime(),endTime:c.meta.dateTime.endDate.toPlainTime()},k=c.kind==="ERKLAERBAER"?"/erklaerbaer":`/helfen/${c.helpEntryUuid}`;i[v].push({range:S,component:()=>l(ll,{title:b,range:S,kind:"help",path:k,link:n})})}),a.forEach(o=>{switch(o.kind){case"SELF":{const c=we(o.meta.dateTime.startDate);me(c!==null,`Date '${JSON.stringify(o.meta.dateTime.startDate)}' is not a valid event date.`);break}case"FRIEND":{const c=we(o.meta.dateTime.startDate);me(c!==null,`Date '${JSON.stringify(o.meta.dateTime.startDate)}' is not a valid event date.`);break}}}),i}function ll(e){const t={"master-draft":{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},master:{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},play:{label:"TN",help:"Teilnehmer:in",link:{icon:"link",label:"Zur Spielrunde"}},help:{label:"HL",help:"Helfen",link:{icon:"link",label:"Zum Eintrag"}}}[e.kind],n=()=>{const r=["timeview-entry","box-simple"];return e.kind==="master-draft"&&r.push("gray"),e.kind==="master"&&r.push("special"),e.kind==="play"&&r.push("danger"),r.join(" ")};return(()=>{var r=g(nl);return u(r,l(V,{get href(){return e.link(e.path)},class:"button-link",style:"display: contents;",get children(){return[l(He,{get title(){return t.help},get inverted(){return e.kind!=="help"},size:"small",get children(){return t.label}}),l(Ue,{get icon(){return t.link.icon},kind:"ghost",get title(){return t.link.label}}),(()=>{var i=g(el);return u(i,()=>e.title),K(()=>ye(i,"title",e.title)),i})(),(()=>{var i=g(tl),a=i.firstChild,s=a.nextSibling,[o,c]=m(s.nextSibling),d=o.nextSibling,h=d.nextSibling,[b,v]=m(h.nextSibling),S=b.nextSibling,k=S.nextSibling,f=k.firstChild,_=f.firstChild,y=_.nextSibling,[x,R]=m(y.nextSibling);return x.nextSibling,u(i,()=>Ce(e.range.startTime),o,c),u(i,()=>Ce(e.range.endTime),b,v),u(f,()=>Vn(e.range.startTime,e.range.endTime),x,R),i})()]}})),K(()=>xe(r,n())),r})()}function al(e){const t=[];return e.FRIDAY.length===0&&t.push("FRIDAY"),e.SATURDAY.length===0&&t.push("SATURDAY"),e.SUNDAY.length===0&&t.push("SUNDAY"),t.length===3?["FRIDAY"]:t}function sl(e){const t=cn;e.FRIDAY.length>0&&(t.FRIDAY=Je.FRIDAY);let n=!1;e.SATURDAY.forEach(i=>{i.range.startTime.hour<t.SATURDAY.open.from&&(n=!0),i.range.endTime.hour>t.SATURDAY.open.to&&(n=!0)}),n&&(t.SATURDAY=Je.SATURDAY);let r=!1;return e.SUNDAY.forEach(i=>{i.range.startTime.hour<t.SUNDAY.open.from&&(r=!0),i.range.endTime.hour>t.SUNDAY.open.to&&(r=!0)}),r&&(t.SUNDAY=Je.SUNDAY),t}function Dt(e,t){const n={get:e,set:r=>t(()=>r),update:t,pipe:r=>r(n)};return n}function ul(e){const[t,n]=ve({value:e});return Dt(()=>t.value,r=>n("value",r(t.value)))}const T={sub:e=>t=>Dt(()=>t.get()[e],n=>t.update(r=>({...r,[e]:n(t.get()[e])})))},re={push:(e,t)=>{e.update(n=>[...n,t])},update:(e,t,n)=>{e.update(r=>r.map(i=>t(i)?n:i))},remove:(e,t)=>{e.update(n=>n.filter(t))},findExact:(e,t)=>(ht(e.get(),t),Dt(()=>ht(e.get(),t),n=>{const r=ht(e.get(),t);re.update(e,t,n(r))}))};function ht(e,t){const[n,...r]=e.filter(t);return me(n!==void 0,"No element found with predicate"),me(r.length===0,"Predicate does not result in unique element"),n}var ol=$("<label class=input-checkbox><input type=checkbox><div><!$><!/><!$><!/>"),cl=$("<div class=checkbox-description>");function dl(e){return(()=>{var t=g(ol),n=t.firstChild,r=n.nextSibling,i=r.firstChild,[a,s]=m(i.nextSibling),o=a.nextSibling,[c,d]=m(o.nextSibling);return n.addEventListener("change",h=>e.checked$.set(h.target.checked)),u(r,()=>e.label,a,s),u(r,l(D,{get when(){return e.description},children:h=>(()=>{var b=g(cl);return u(b,h),b})()}),c,d),K(h=>{var b=e.name,v=e.disabled===!0;return b!==h.e&&ye(n,"name",h.e=b),v!==h.t&&fe(n,"disabled",h.t=v),h},{e:void 0,t:void 0}),K(()=>fe(n,"value",e.value)),K(()=>fe(n,"checked",e.checked$.get())),t})()}var gl=$("<div style=display:grid;gap:1rem><!$><!/><!$><!/><!$><!/>"),hl=$("<div>"),ml=$("<div style=display:grid;gap:1rem><h3>Meine Kontaktdaten</h3><p><strong>Name:</strong> <!$><!/></p><p><strong>E-Mail:</strong> <!$><!/></p><p><strong>Handynummer:</strong> <!$><!/></p><!$><!/>"),$l=$("<form novalidate><!$><!/><!$><!/><!$><!/><!$><!/>");function fl(e){return(()=>{var t=g(gl),n=t.firstChild,[r,i]=m(n.nextSibling),a=r.nextSibling,[s,o]=m(a.nextSibling),c=s.nextSibling,[d,h]=m(c.nextSibling);return u(t,l(bl,{get contact$(){return e.save$.pipe(T.sub("contact"))},get isEditable(){return e.isEditable}}),r,i),u(t,l(dl,{label:"Schickt mir bitte E-Mails, wenn neue Programmpunkte veröffentlicht werden.",get checked$(){return e.save$.pipe(T.sub("config")).pipe(T.sub("wantsUpdates"))},name:"wantsUpdates",value:"wantsUpdates"}),s,o),u(t,l(je,{get fallback(){return l(E,{get children(){return C.loading.program}})},get children(){return l(D,{get when(){return e.publicResource()},get fallback(){return l(E,{type:"danger",get children(){return C.error.help}})},children:b=>l(D,{get when(){return b().kind==="SUCCESS"},get fallback(){return l(E,{type:"danger",get children(){return C.loading.program}})},get children(){return l(rl,{get save(){return e.save$.get()},get publicState(){return b().data},get link(){return e.link}})}})})}}),d,h),t})()}function bl(e){const[t,n]=ve(Ji()),{name:r,email:i,mobile:a}=e.contact$.get();return l(E,{get children(){return[l(D,{get when(){return t.open},get children(){return l(Sl,{get contact$(){return e.contact$},dialogStore:t})}}),(()=>{var s=g(ml),o=s.firstChild,c=o.nextSibling,d=c.firstChild,h=d.nextSibling,b=h.nextSibling,[v,S]=m(b.nextSibling),k=c.nextSibling,f=k.firstChild,_=f.nextSibling,y=_.nextSibling,[x,R]=m(y.nextSibling),w=k.nextSibling,P=w.firstChild,L=P.nextSibling,O=L.nextSibling,[M,I]=m(O.nextSibling),Q=w.nextSibling,[W,X]=m(Q.nextSibling);return u(c,r,v,S),u(k,i,x,R),u(w,a,M,I),u(s,l(D,{get when(){return e.isEditable},get children(){var Z=g(hl);return u(Z,l(Se,{icon:"pencil",label:"Kontaktdaten editieren",onClick:()=>n("open",!0)})),Z}}),W,X),s})()]}})}function Sl(e){const[t]=Br(),[n]=ve({name:gt(e.contact$.get().name),email:gt(e.contact$.get().email),mobile:gt(e.contact$.get().mobile)}),[r,i]=ve({kind:"IDLE",isDuplicate:!1}),a=ne(()=>{const c={name:[],email:[]};return n.name.value.trim().length===0&&c.name.push(C.mandatoryField),n.email.value.trim().length===0?c.email.push(C.mandatoryField):n.email.value.includes("@")||c.email.push(C.invalidEmail),r.kind==="IDLE"&&r.isDuplicate&&c.email.push("Diese E-Mail wird bereits verwendet."),{...c,hasErrors:c.name.length+c.email.length>0}}),[s,o]=ve(e.dialogStore);return l(Gi,{get store(){return e.dialogStore},title:"Kontaktdaten editieren",onClose:()=>{},size:"medium",get children(){var c=g($l),d=c.firstChild,[h,b]=m(d.nextSibling),v=h.nextSibling,[S,k]=m(v.nextSibling),f=S.nextSibling,[_,y]=m(f.nextSibling),x=_.nextSibling,[R,w]=m(x.nextSibling);return u(c,l(dt,{get store(){return n.name},label:"Name",name:"name",showErrors:"ON_BLUR",get errors(){return a().name}}),h,b),u(c,l(dt,{get store(){return n.email},label:"E-Mail",name:"email",showErrors:"ALWAYS",get errors(){return a().email},onUpdate:()=>i({kind:"IDLE",isDuplicate:!1})}),S,k),u(c,l(dt,{get store(){return n.mobile},label:"Handynummer",name:"mobile"}),_,y),u(c,l(oe,{label:"Speichern",get disabled(){return a().hasErrors||r.kind==="CHECKING"},onClick:async()=>{if(!a().hasErrors){i({kind:"CHECKING"});const P=t.secret,L=await fetch(Be(`/lst26/check-email?email=${n.email.value}&secret=${P}`));if(!L.ok){i({kind:"IDLE",isDuplicate:!0});return}const O=await L.json(),M=_l.safeParse(O);if(!M.success){i({kind:"IDLE",isDuplicate:!0});return}if(M.data.kind==="FAILURE"){i({kind:"IDLE",isDuplicate:!0});return}i({kind:"IDLE",isDuplicate:!1}),e.contact$.set({name:n.name.value,email:n.email.value,mobile:n.mobile.value}),o("open",!1)}}}),R,w),c}})}const _l=ze([F({kind:le("SUCCESS")}),F({kind:le("FAILURE")})]);var vl=$("<div class=tooltip-wrapper><div class=tooltip></div><!$><!/>");function Ne(e){return(()=>{var t=g(vl),n=t.firstChild,r=n.nextSibling,[i,a]=m(r.nextSibling);return u(n,()=>e.tooltip),u(t,()=>e.children,i,a),t})()}var kl=$("<div class=quickmenu-wrapper><div class=quickmenu><!$><!/><!$><!/><!$><!/><!$><!/>"),yl=$('<div class="quickmenu extended"><!$><!/><!$><!/><!$><!/><!$><!/>'),xl=$("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center><!$><!/><em>Zuletzt gespeichert um: <!$><!/> Uhr"),Dl=$("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center><!$><!/><em>Am Speichern..."),El=$("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center><!$><!/><em>Speichern war nicht möglich!");function pl(e){return(()=>{var t=g(kl),n=t.firstChild,r=n.firstChild,[i,a]=m(r.nextSibling),s=i.nextSibling,[o,c]=m(s.nextSibling),d=o.nextSibling,[h,b]=m(d.nextSibling),v=h.nextSibling,[S,k]=m(v.nextSibling);return u(n,l(Ne,{tooltip:"Zur Übersicht",get children(){return l(V,{get href(){return e.link(e.parentPath)},class:"button-link",get children(){return l(oe,{get label(){return l(ue,{icon:"backward"})}})}})}}),i,a),u(n,l(D,{get when(){return e.roles.includes("admin")},get children(){return[l(Ne,{tooltip:"Zum Programm",get children(){return l(V,{get href(){return e.link("/programm")},class:"button-link",get children(){return l(oe,{get label(){return l(ue,{icon:"dice-d20"})}})}})}}),l(Ne,{tooltip:"Zu deinen Programmpunkten",get children(){return l(V,{get href(){return e.link("/erstellen")},class:"button-link",get children(){return l(oe,{get label(){return l(ue,{icon:"grid-2-plus"})}})}})}})]}}),o,c),u(n,l(Ne,{tooltip:"Zum Helferplan",get children(){return l(V,{get href(){return e.link("/helfen")},class:"button-link",get children(){return l(oe,{get label(){return l(ue,{icon:"hand-heart"})}})}})}}),h,b),u(n,l(Ne,{tooltip:"Zur Zusammenfassung",get children(){return l(V,{get href(){return e.link("/zusammenfassung")},class:"button-link",get children(){return l(oe,{get label(){return l(ue,{icon:"list"})}})}})}}),S,k),t})()}function Al(e){return[l(E,{type:"gray",get children(){var t=g(yl),n=t.firstChild,[r,i]=m(n.nextSibling),a=r.nextSibling,[s,o]=m(a.nextSibling),c=s.nextSibling,[d,h]=m(c.nextSibling),b=d.nextSibling,[v,S]=m(b.nextSibling);return u(t,l(V,{get href(){return e.link(e.parentPath)},class:"button-link",get children(){return l(Se,{icon:"backward",label:"Zur Übersicht"})}}),r,i),u(t,l(D,{get when(){return e.roles.includes("admin")},get children(){return[l(V,{get href(){return e.link("/programm")},class:"button-link",get children(){return l(Se,{icon:"dice-d20",label:"Zum Programm"})}}),l(V,{get href(){return e.link("/erstellen")},class:"button-link",get children(){return l(Se,{icon:"grid-2-plus",label:"Zu deinen Programmpunkten"})}})]}}),s,o),u(t,l(V,{get href(){return e.link("/helfen")},class:"button-link",get children(){return l(Se,{icon:"hand-heart",label:"Zum Helferplan"})}}),d,h),u(t,l(V,{get href(){return e.link("/zusammenfassung")},class:"button-link",get children(){return l(Se,{icon:"list",label:"Zur Zusammenfassung"})}}),v,S),t}}),l(Rl,{get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})]}function Rl(e){return l(Me,{get children(){return[l(he,{get when(){return e.saveState==="IDLE"},get children(){var t=g(xl),n=t.firstChild,[r,i]=m(n.nextSibling),a=r.nextSibling,s=a.firstChild,o=s.nextSibling,[c,d]=m(o.nextSibling);return c.nextSibling,u(t,l(ue,{icon:"circle-check"}),r,i),u(a,()=>Bt(e.lastSaved),c,d),t}}),l(he,{get when(){return e.saveState==="SAVING"},get children(){var t=g(Dl),n=t.firstChild,[r,i]=m(n.nextSibling);return r.nextSibling,u(t,l(ue,{icon:"floppy-disk-circle-arrow-right"}),r,i),t}}),l(he,{get when(){return e.saveState==="ERROR"},get children(){var t=g(El),n=t.firstChild,[r,i]=m(n.nextSibling);return r.nextSibling,u(t,l(ue,{icon:"triangle-exclamation"}),r,i),t}})]}})}var wl=$("<div class=page><!$><!/><div class=page-content><!$><!/><!$><!/></div><!$><!/>"),Tl=$("<h2>"),Ul=$("<br>"),Cl=$("<div class=extended-wrapper style=margin-block-start:1rem>");function be(e){return(()=>{var t=g(wl),n=t.firstChild,[r,i]=m(n.nextSibling),a=r.nextSibling,s=a.firstChild,[o,c]=m(s.nextSibling),d=o.nextSibling,[h,b]=m(d.nextSibling),v=a.nextSibling,[S,k]=m(v.nextSibling);return u(t,(()=>{var f=z(()=>e.showQuickmenu!==!1);return()=>f()?l(pl,{get roles(){return e.roles},get link(){return e.link},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved},get parentPath(){return e.parentPath??"/"}}):null})(),r,i),u(a,(()=>{var f=z(()=>e.title===void 0);return()=>f()?null:[(()=>{var _=g(Tl);return u(_,()=>e.title),_})(),g(Ul)]})(),o,c),u(a,()=>e.children,h,b),u(t,(()=>{var f=z(()=>e.showQuickmenu!==!1);return()=>f()?(()=>{var _=g(Cl);return u(_,l(Al,{get roles(){return e.roles},get link(){return e.link},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved},get parentPath(){return e.parentPath??"/"}})),_})():null})(),S,k),t})()}var Pl=$('<form class=input-button style="display:grid;gap:0rem;grid-template-columns:1fr max-content"><input type=text style=border-color:var(--clr-special-9)><!$><!/>');function Lt(e){const[t,n]=ie("");return(()=>{var r=g(Pl),i=r.firstChild,a=i.nextSibling,[s,o]=m(a.nextSibling);return r.addEventListener("submit",c=>{c.preventDefault();const d=t();d.trim().length>0&&e.addFriend(d)}),fe(r,"noValidate",!0),i.$$input=c=>n(c.target.value),u(r,l(Se,{icon:"arrow-right",type:"submit",label:"Begleitperson anmelden",kind:"special"}),s,o),K(()=>fe(i,"value",t())),Qe(),r})()}vt(["input"]);var Fl=$("<p>Details konnten nicht geladen werden."),Ll=$("<div style=display:flex;gap:1rem;flex-wrap:wrap;justify-content:space-between><h3></h3><!$><!/>"),Il=$("<div class=game-dialog><ul role=list style=display:grid;gap:0.5rem><li><strong style=color:var(--clr-accent-1)>Tag, Zeit:</strong> <br><!$><!/>, <!$><!/> - <!$><!/> Uhr</li><li><strong style=color:var(--clr-accent-1)>Beschreibung:</strong> <br><!$><!/></li></ul><div class=reservations><h5 style=margin-block-start:0>Plätze reservieren</h5><div class=reservation-table>"),Nl=$("<div class=count>"),Yl=$("<div class=reservation-table-entry><p>Reserviert für mich </p><!$><!/>"),Ol=$('<div class=reservation-table-entry><p>Reserviert für "<!$><!/>"</p><!$><!/>'),Hl=$('<div style="display:grid;gap:1rem;grid-template-columns:max-content 1fr"><!$><!/><!$><!/>');function Bl(e){const t=an().uuid??"no-uuid-found",n=Ti(t);return l(je,{get fallback(){return l(E,{get children(){return C.loading.program}})},get children(){return l(D,{get when(){return e.publicResource()},get fallback(){return l(E,{type:"danger",get children(){return C.error.help}})},children:r=>l(D,{get when(){return r().kind==="SUCCESS"},get fallback(){return l(E,{type:"danger",get children(){return C.loading.program}})},get children(){return l(D,{when:n,get fallback(){return l(E,{type:"danger",get children(){return g(Fl)}})},children:i=>l(zl,{get entry(){return i()},get myHelpReservations(){return e.reservations$.get()},get allReservations(){return r().data.reservations},get isEditable(){return e.isEditable},addReservation:a=>re.push(e.reservations$,{...a,uuid:crypto.randomUUID()}),removeReservation:a=>{re.remove(e.reservations$,s=>s.uuid!==a)},get link(){return e.link}})})}})})}})}function zl(e){const{dateTime:t,kind:n}=e.entry,r=pe[n],i=we(t.startDate);me(i!==null,`Date '${JSON.stringify(t.startDate)}' is not a valid event date.`);const a=()=>e.myHelpReservations.filter(d=>"helpEntryUuid"in d&&d.helpEntryUuid===e.entry.uuid),s=(e.allReservations[e.entry.uuid]??0)-a().length,o=()=>Gt(e.entry.count).map(d=>{const h=a()[d];return h!==void 0?h:e.entry.count-s<=d?{kind:"RESERVED_OTHER"}:{kind:"FREE"}}),c=()=>a().find(d=>d.kind==="SELF")!==void 0;return[(()=>{var d=g(Ll),h=d.firstChild,b=h.nextSibling,[v,S]=m(b.nextSibling);return u(h,()=>r.title),u(d,l(V,{get href(){return e.link("/helfen")},class:"button-link",get children(){return l(Se,{icon:"backward",label:"Zurück zur Helfer-Übersicht"})}}),v,S),d})(),(()=>{var d=g(Il),h=d.firstChild,b=h.firstChild,v=b.firstChild,S=v.nextSibling,k=S.nextSibling,f=k.nextSibling,[_,y]=m(f.nextSibling),x=_.nextSibling,R=x.nextSibling,[w,P]=m(R.nextSibling),L=w.nextSibling,O=L.nextSibling,[M,I]=m(O.nextSibling);M.nextSibling;var Q=b.nextSibling,W=Q.firstChild,X=W.nextSibling,Z=X.nextSibling,p=Z.nextSibling,[A,H]=m(p.nextSibling),ee=h.nextSibling,ge=ee.firstChild,q=ge.nextSibling;return u(b,()=>C.days[i],_,y),u(b,()=>Ce(t.startDate.toPlainTime(),{minutes:!1}),w,P),u(b,()=>Ce(t.endDate.toPlainTime(),{minutes:!1}),M,I),u(Q,()=>r.description,A,H),u(q,l(J,{get each(){return o()},children:(B,te)=>[(()=>{var N=g(Nl);return u(N,()=>te()+1),N})(),l(Me,{get children(){return[l(he,{get when(){return B.kind==="RESERVED_OTHER"},get children(){return l(E,{children:"Bereits reserviert"})}}),l(he,{get when(){return!e.isEditable},get children(){return l(E,{children:"Freier Platz"})}}),l(he,{get when(){return B.kind==="SELF"},get children(){return l(Rt,{type:"success",get children(){var N=g(Yl),G=N.firstChild,ae=G.nextSibling,[De,se]=m(ae.nextSibling);return u(N,l(Ue,{icon:"trash",onClick:()=>e.removeReservation(B.kind==="SELF"?B.uuid:"should not happen")}),De,se),N}})}}),l(he,{get when(){return B.kind==="FRIEND"},get children(){return l(Rt,{type:"success",get children(){var N=g(Ol),G=N.firstChild,ae=G.firstChild,De=ae.nextSibling,[se,Pe]=m(De.nextSibling);se.nextSibling;var Fe=G.nextSibling,[Le,rt]=m(Fe.nextSibling);return u(G,(()=>{var fn=z(()=>B.kind==="FRIEND");return()=>fn()?B.name:"[Fehler beim Laden]"})(),se,Pe),u(N,l(Ue,{icon:"trash",onClick:()=>e.removeReservation(B.kind==="FRIEND"?B.uuid:"should not happen")}),Le,rt),N}})}}),l(he,{get when(){return B.kind==="FREE"},get children(){return l(D,{get when(){return c()},get fallback(){return(()=>{var N=g(Hl),G=N.firstChild,[ae,De]=m(G.nextSibling),se=ae.nextSibling,[Pe,Fe]=m(se.nextSibling);return u(N,l(Se,{icon:"person-to-portal",label:"Mich anmelden",kind:"success",onClick:()=>e.addReservation({kind:"SELF",helpEntryUuid:e.entry.uuid,uuid:crypto.randomUUID()})}),ae,De),u(N,l(Lt,{addFriend:Le=>e.addReservation({kind:"FRIEND",helpEntryUuid:e.entry.uuid,name:Le,uuid:crypto.randomUUID()})}),Pe,Fe),N})()},get children(){return l(Lt,{addFriend:N=>e.addReservation({kind:"FRIEND",helpEntryUuid:e.entry.uuid,name:N,uuid:crypto.randomUUID()})})}})}})]}})]})),d})()]}var Ml=$("<ul role=list>"),jl=$("<li>"),Kl=$("<label class=input-radio><input type=radio><!$><!/>");function Wl(e){const t=e.layout??"vertical";return(()=>{var n=g(Ml);return xe(n,`radio-list ${t}`),u(n,l(J,{get each(){return e.items},children:r=>(()=>{var i=g(jl);return u(i,l(Zl,{get label(){return r.label},get name(){return`${r.value}-${e.name}`},get value(){return r.value},get checked(){return r.checked},onValueUpdate:()=>e.onValueUpdate(r.value)})),i})()})),n})()}function Zl(e){return(()=>{var t=g(Kl),n=t.firstChild,r=n.nextSibling,[i,a]=m(r.nextSibling);return Zt(n,"change",e.onValueUpdate),u(t,()=>e.label,i,a),K(()=>ye(n,"name",e.name)),K(()=>fe(n,"value",e.value)),K(()=>fe(n,"checked",e.checked)),t})()}var Vl=$("<p>Eines der Hauptziele der Luzerner Spieltage ist es, dass die Besucher/-innen noch nicht gespielte Spiele ausprobieren können. Dazu unterstützen uns jedes Jahr Freiwillige und erklären die ihnen bekannten Spiele aus der Spiele-Bibliothek. Diese Erklärbären sind durch ihr rotes T-Shirt erkennbar."),Et=$("<br>"),ql=$("<div class=dynamic-columns><div></div><div><!$><!/><ul><li>Sie müssen nicht alle Spiele der Spiele-Bibliothek kennen!</li><li>Sie erklären Spiele während der eingeplanten Zeit<ul><li>Grundsätzlich spielen die Erklärbären nicht mit</li><li>Sobald die Spieler/-innen die Regeln verstanden haben (z.B. nach den ersten paar Runden) verlassen sie den Tisch</li><li>Sie stehen weiterhin für Fragen zur Verfügung und kommen allenfalls periodisch zum Tisch zurück</li></ul></li><li>Sie bringen Spiele für die Spiele-Bibliothek mit welche sie erklären können<ul><li>Diese Spiele sollen ein breites Spektrum, von einfach bis komplex, abdecken</li><li>Eine Liste der mitgebrachten Spiele (Spiele-Bibliothek) wird vor dem Event von allen Erklärbären zusammen erstellt</li><li>Vor dem Event notieren die Erklärbären, was sie aus der Spiele-Bibliothek erklären können - (Mitbringen eigener Spiele ist nicht Pflicht, falls genügend Spiele aus der Liste erklärt werden können)</li></ul></li><li>Sie erarbeiten gemeinsam vor dem Event eine Empfehlungsliste aus ca.&nbsp;6&nbsp;Spielen<ul><li>Alle Erklärbären sollen die Regeln dieser Spiele vor dem Event lesen"),Jl=$("<h3>"),Gl=$("<div style=display:grid;gap:1rem><!$><!/><!$><!/>"),Ql=$("<p>Bitte nimm mit uns <!$><!/> auf, damit wir uns kurz mit dir absprechen und dir diesen Bereich freischalten können."),Xl=$("<em>Noch keine Einsätze eingetragen"),ea=$("<h4>Tag"),ta=$("<h4>Uhrzeit"),na=$('<div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1rem"><!$><!/><!$><!/>'),ra=$("<h5>Warnungen"),ia=$("<ul>"),la=$("<li>"),aa=$("<h4>Übersicht über alle Erklärbären"),sa=$("<div class=dynamic-columns><div><h5>Samstag</h5><table><tr><th>Name</th><th>Zeit</th></tr><tbody></tbody></table></div><div><h5>Sonntag</h5><table><tr><th>Name</th><th>Zeit</th></tr><tbody>"),It=$("<tr><td></td><td><!$><!/> - <!$><!/> Uhr");function ua(e){return[g(Vl),g(Et),(()=>{var t=g(ql),n=t.firstChild,r=n.nextSibling,i=r.firstChild,[a,s]=m(i.nextSibling);return a.nextSibling,u(n,l(oa,{get reservations$(){return e.save$.pipe(T.sub("helping"))},get roles(){return e.roles},get isEditable(){return e.isEditable}})),u(r,l(We,{level:3,title:"Was machen die Erklärbären"}),a,s),t})(),l(D,{get when(){return e.adminResource()},children:t=>l(da,{get adminResource(){return t()}})})]}function oa(e){function t(){return e.reservations$.get().filter(n=>n.kind==="ERKLAERBAER")}return[l(We,{level:3,title:"Meine Einsätze"}),g(Et),l(Me,{get fallback(){return l(E,{get children(){var n=g(Ql),r=n.firstChild,i=r.nextSibling,[a,s]=m(i.nextSibling);return a.nextSibling,u(n,l($e,{href:"/kontakt",children:"Kontakt"}),a,s),n}})},get children(){return l(he,{get when(){return e.roles.includes("erklaerbaer")},get children(){var n=g(Gl),r=n.firstChild,[i,a]=m(r.nextSibling),s=i.nextSibling,[o,c]=m(s.nextSibling);return u(n,l(J,{get each(){return t()},get fallback(){return g(Xl)},children:d=>l(ca,{job:d,updateJob:h=>{re.update(e.reservations$,b=>b.uuid===d.uuid,h)},removeJob:()=>{re.remove(e.reservations$,h=>h.uuid!==d.uuid)},get isEditable(){return e.isEditable}})}),i,a),u(n,l(D,{get when(){return e.isEditable},get children(){return l(_e,{icon:"grid-2-plus",type:"success",onClick:()=>{re.push(e.reservations$,{kind:"ERKLAERBAER",uuid:crypto.randomUUID(),slot:{day:"SATURDAY",from:10,to:18}})},get children(){var d=g(Jl);return u(d,()=>C.createNewEntry),d}})}}),o,c),n}})}})]}function ca(e){function t(){const n=[],{day:r,from:i,to:a}=e.job.slot;i>=a&&n.push("Das Ende muss grösser sein als der Start.");const s=cn[r],{from:o,to:c}=s.open;return o>i&&n.push(`Die Spieltage öffnen am ${C.days[r]} erst um ${o} Uhr.`),c<a&&n.push(`Die Spieltage schliessen am ${C.days[r]} um ${c} Uhr.`),n}return l(E,{get onClose(){return z(()=>!!e.isEditable)()?e.removeJob:void 0},get children(){return[g(ea),l(Wl,{get items(){return[{label:C.days.SATURDAY,checked:e.job.slot.day==="SATURDAY",value:"SATURDAY"},{label:C.days.SUNDAY,checked:e.job.slot.day==="SUNDAY",value:"SUNDAY"}]},onValueUpdate:n=>{e.updateJob({...e.job,slot:{...e.job.slot,day:n}})},get name(){return`day-entry-${e.job.uuid}`},layout:"horizontal",get disabled(){return!e.isEditable}}),g(Et),g(ta),(()=>{var n=g(na),r=n.firstChild,[i,a]=m(r.nextSibling),s=i.nextSibling,[o,c]=m(s.nextSibling);return u(n,l(mt,{label:"Start",name:"from",get value(){return e.job.slot.from},onValueUpdate:d=>e.updateJob({...e.job,slot:{...e.job.slot,from:d}}),get disabled(){return!e.isEditable}}),i,a),u(n,l(mt,{label:"Ende",name:"to",get value(){return e.job.slot.to},onValueUpdate:d=>e.updateJob({...e.job,slot:{...e.job.slot,to:d}}),get disabled(){return!e.isEditable}}),o,c),n})(),l(D,{get when(){return t().length>0},get children(){return[g(ra),(()=>{var n=g(ia);return u(n,l(J,{get each(){return t()},children:r=>(()=>{var i=g(la);return u(i,r),i})()})),n})()]}})]}})}function da(e){if(e.adminResource.kind==="FAILURE"||e.adminResource.data.erklaerbaer===null)return null;const t=ga(e.adminResource.data.erklaerbaer.entries);return[g(aa),(()=>{var n=g(sa),r=n.firstChild,i=r.firstChild,a=i.nextSibling,s=a.firstChild,o=s.nextSibling,c=r.nextSibling,d=c.firstChild,h=d.nextSibling,b=h.firstChild,v=b.nextSibling;return u(o,l(J,{get each(){return t.SATURDAY},children:S=>(()=>{var k=g(It),f=k.firstChild,_=f.nextSibling,y=_.firstChild,[x,R]=m(y.nextSibling),w=x.nextSibling,P=w.nextSibling,[L,O]=m(P.nextSibling);return L.nextSibling,u(f,()=>S.name),u(_,()=>S.slot.from,x,R),u(_,()=>S.slot.to,L,O),k})()})),u(v,l(J,{get each(){return t.SUNDAY},children:S=>(()=>{var k=g(It),f=k.firstChild,_=f.nextSibling,y=_.firstChild,[x,R]=m(y.nextSibling),w=x.nextSibling,P=w.nextSibling,[L,O]=m(P.nextSibling);return L.nextSibling,u(f,()=>S.name),u(_,()=>S.slot.from,x,R),u(_,()=>S.slot.to,L,O),k})()})),n})()]}function ga(e){const{FRIDAY:t,SATURDAY:n,SUNDAY:r}=Object.groupBy(e,i=>i.slot.day);return{FRIDAY:(t??[]).toSorted((i,a)=>i.slot.from-a.slot.from||i.slot.to-a.slot.to),SATURDAY:(n??[]).toSorted((i,a)=>i.slot.from-a.slot.from||i.slot.to-a.slot.to),SUNDAY:(r??[]).toSorted((i,a)=>i.slot.from-a.slot.from||i.slot.to-a.slot.to)}}function ha(){return l(E,{children:"Inhalt folgt."})}const Nt=200,Yt=500;function gn(e){const t={};e.title.trim().length===0&&(t.title=[...t.title??[],"Titel ist ein Pflichtfeld"]),e.organizer.trim().length===0&&(t.organizer=[...t.organizer??[],"'Organisiert durch' ist ein Pflichtfeld"]),e.shortDescription.trim().length===0&&(t.shortDescription=[...t.shortDescription??[],"'Kurze Beschreibung' ist ein Pflichtfeld"]),e.shortDescription.trim().length>Nt&&(t.shortDescription=[...t.shortDescription??[],C.charLimitBy.replace("{}",String(Nt))]),e.longDescription.trim().length>Yt&&(t.longDescription=[...t.longDescription??[],C.charLimitBy.replace("{}",String(Yt))]),e.timeSlots.length===0?t.timeSlots=[...t.timeSlots??[],C.missingSlot]:e.timeSlots.forEach(r=>{const i=Ge(r.start.time);i.kind==="ERROR"&&(t.timeSlots=[...t.timeSlots??[],"Fehler im Zeitslot, 'Start'"]);const a=Ge(r.end.time);a.kind==="ERROR"&&(t.timeSlots=[...t.timeSlots??[],"Fehler im Zeitslot, 'Ende'"]),i.kind==="TIME"&&a.kind==="TIME"&&a.value.since(i.value).hours<0&&(t.timeSlots=[...t.timeSlots??[],"Zeitfenster fehlerhaft ('Ende' vor 'Start')"])});const n=Object.values(t).flat();return{allErrors:n,byField:t,hasErrors:n.length>0}}var ma=$("<ul class=link-list role=list>"),$a=$("<br>"),Ot=$("<h3>"),fa=$("<li>"),ba=$("<span> mit Fehlern");function Sa(e){const t=xt();return[(()=>{var n=g(ma);return u(n,l(J,{get each(){return e.programEntries$.get()},children:r=>{const i=gn(r);return(()=>{var a=g(fa);return u(a,l(V,{get href(){return e.link(`/erstellen/${r.uuid}`)},class:"button-link",get children(){return l(_e,{get icon(){return i.hasErrors?"triangle-exclamation":"arrow-right"},get type(){return i.hasErrors?"danger":"special"},get children(){return[(()=>{var s=g(Ot);return u(s,(()=>{var o=z(()=>r.title.trim().length===0);return()=>o()?"[Titel fehlt noch]":r.title})()),s})(),l(He,{get kind(){return i.hasErrors?"danger":"special"},get children(){return["Status: ",z(()=>C.publishingSteps[r.status]),z(()=>z(()=>!!i.hasErrors)()?g(ba):"")]}})]}})}})),a})()}})),n})(),g($a),l(D,{get when(){return e.isEditable},get children(){return l(_e,{icon:"grid-2-plus",type:"success",onClick:()=>{const n=crypto.randomUUID();re.push(e.programEntries$,{uuid:n,status:"draft",title:"",organizer:"",shortDescription:"",longDescription:"",participating:{kind:"LIMITED",maxSeats:6},timeSlots:[],tagNames:""}),t(e.link(`/erstellen/${n}`))},get children(){var n=g(Ot);return u(n,()=>C.createNewGameRound),n}})}})]}var hn=$("<p>");function Oe(e){const[t,n]=ie(!1),r=e.showErrors==="ALWAYS",i=()=>r||t()?e.errors??[]:[];return[l(zt,{get label(){return e.label},get name(){return e.name},get value(){return e.value$.get()},onValueUpdate:a=>e.value$.set(a),onBlur:()=>n(!0),get type(){return e.type},get required(){return e.required},get disabled(){return e.disabled}}),l(D,{get when(){return i().length>0},get children(){return l(E,{type:"danger",get children(){return l(J,{get each(){return i()},children:a=>(()=>{var s=g(hn);return u(s,a),s})()})}})}})]}function _a(e){const[t,n]=ie(!1),r=e.showErrors==="ALWAYS",i=()=>r||t()?e.errors??[]:[];return[l(mt,{get label(){return e.label},get name(){return e.name},get value(){return e.value$.get()},onValueUpdate:a=>e.value$.set(a),onBlur:()=>n(!0),get required(){return e.required},get min(){return e.min},get max(){return e.max},get disabled(){return e.disabled}}),l(D,{get when(){return i().length>0},get children(){return l(E,{type:"danger",get children(){return l(J,{get each(){return i()},children:a=>(()=>{var s=g(hn);return u(s,a),s})()})}})}})]}const va=200;var ka=$("<button class=event-link><span>Details & Teilnahme"),ya=$('<li class=event-entry><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Organisiert durch:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><span><!$><!/>, <!$><!/> - <!$><!/> Uhr</span></div><div class=event-tags></div><div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li>'),xa=$("<em>Teilnahme ohne Anmeldung möglich."),Da=$("<strong>Freie Plätze:"),Ea=$("<em>keine Kategorien");function pa(e){return(()=>{var t=g(ya),n=t.firstChild,r=n.nextSibling,i=r.firstChild,a=i.firstChild,s=a.nextSibling,[o,c]=m(s.nextSibling),d=i.nextSibling,h=d.firstChild,b=h.nextSibling,v=b.firstChild,[S,k]=m(v.nextSibling),f=S.nextSibling,_=f.nextSibling,[y,x]=m(_.nextSibling),R=y.nextSibling,w=R.nextSibling,[P,L]=m(w.nextSibling);P.nextSibling;var O=d.nextSibling,M=O.nextSibling,I=M.firstChild,Q=I.nextSibling,W=Q.nextSibling,[X,Z]=m(W.nextSibling),p=r.nextSibling,A=p.firstChild,H=A.firstChild,ee=H.nextSibling,ge=ee.nextSibling,[q,B]=m(ge.nextSibling),te=p.nextSibling,N=te.firstChild;return u(n,()=>e.entry.title),u(i,()=>e.entry.organizer,o,c),u(b,()=>C.days[we(e.entry.timeSlot.startDate)??"FRIDAY"],S,k),u(b,()=>Ce(e.entry.timeSlot.startDate.toPlainTime()),y,x),u(b,()=>Ce(e.entry.timeSlot.endDate.toPlainTime()),P,L),u(O,(()=>{var G=z(()=>e.entry.participating.kind==="NONE");return()=>G()?g(xa):[g(Da)," ",z(()=>Math.max(e.entry.participating.maxSeats-e.reservations,0))," ","(von ",z(()=>e.entry.participating.maxSeats),")"]})()),u(M,(()=>{var G=z(()=>e.entry.tagNames.trim().length>0);return()=>G()?e.entry.tagNames.split(",").map(ae=>ae.trim()).filter(ae=>ae.length>0).join(", "):g(Ea)})(),X,Z),u(A,()=>vn(e.entry.shortDescription,va),q,B),u(N,l(V,{get href(){return e.link(`${e.basePath}/${e.entry.uuid}`)},class:"button-link",get children(){return g(ka)}})),t})()}var Aa=$("<p>");function Ht(e){const[t,n]=ie(!1),r=e.showErrors==="ALWAYS",i=()=>r||t()?e.errors??[]:[];return[l(In,{get label(){return e.label},get name(){return e.name},get value(){return e.value$.get()},onValueUpdate:a=>e.value$.set(a),onBlur:()=>n(!0),get required(){return e.required},get size(){return e.size},get disabled(){return e.disabled}}),l(D,{get when(){return i().length>0},get children(){return l(E,{type:"danger",get children(){return l(J,{get each(){return i()},children:a=>(()=>{var s=g(Aa);return u(s,a),s})()})}})}})]}var Ra=$("<label class=input-checkbox><!$><!/><input type=checkbox><!$><!/>");function wa(e){return(()=>{var t=g(Ra),n=t.firstChild,[r,i]=m(n.nextSibling),a=r.nextSibling,s=a.nextSibling,[o,c]=m(s.nextSibling);return u(t,()=>e.labels.left,r,i),Zt(a,"blur",e.onBlur),a.addEventListener("change",d=>e.onChange(d.target.checked)),u(t,()=>e.labels.right,o,c),K(d=>{var h=e.name,b=e.disabled;return h!==d.e&&ye(a,"name",d.e=h),b!==d.t&&fe(a,"disabled",d.t=b),d},{e:void 0,t:void 0}),K(()=>fe(a,"value",e.value)),K(()=>fe(a,"checked",e.checked)),t})()}var Ta=$("<p>");function mn(e){const[t,n]=ie(!1),r=e.showErrors==="ALWAYS",i=()=>r||t()?e.errors??[]:[];return[l(wa,{get labels(){return{left:e.options.left.label,right:e.options.right.label}},get name(){return e.name},get checked(){return e.value$.get()===e.options.right.value},onChange:a=>e.value$.set(a?e.options.right.value:e.options.left.value),onBlur:()=>n(!0),get value(){return e.name},get disabled(){return e.disabled===!0}}),l(D,{get when(){return i().length>0},get children(){return l(E,{type:"danger",get children(){return l(J,{get each(){return i()},children:a=>(()=>{var s=g(Ta);return u(s,a),s})()})}})}})]}var Ua=$("<p>Details konnten nicht geladen werden."),Ca=$("<h2>"),Pa=$("<div class=dynamic-columns><div><form novalidate><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/></form></div><div><h3>Vorschau</h3><br><div style=display:flex;gap:1rem;flex-wrap:wrap;align-items:center;justify-content:space-between><!$><!/><!$><!/></div><br><!$><!/><br><ul role=list class=link-list>"),Fa=$("<span> mit Fehlern <!$><!/>"),La=$("<em>Keine (gültigen) Zeitslots gefunden"),Ia=$("<h4>Spielrunde inkomplett"),Na=$("<p>Du hast noch einen oder mehre Fehler/fehlende Informationen in dieser Spielrunde:"),Ya=$("<ul>"),$n=$("<li>"),Oa=$("<label>Zeitfenster"),Ha=$("<h3>Neues Zeitfenster"),Ba=$("<ul role=list class=link-list><!$><!/><li>"),za=$("<div style=display:grid;gap:1rem><div><label>Tag</label><div style=display:flex;flex-wrap:wrap;gap:0.5rem><!$><!/><!$><!/></div></div><!$><!/><!$><!/>");function Ma(e){const t=an().uuid??"no-uuid-found";return l(je,{get fallback(){return l(E,{get children(){return C.loading.program}})},get children(){return l(D,{get when(){return e.publicResource()},get fallback(){return l(E,{type:"danger",get children(){return C.error.help}})},children:n=>l(D,{get when(){return n().kind==="SUCCESS"},get fallback(){return l(E,{type:"danger",get children(){return C.loading.program}})},get children(){return l(Vt,{get fallback(){return l(E,{type:"danger",get children(){return g(Ua)}})},get children(){return l(ja,{get entry$(){return re.findExact(e.programEntries$,r=>r.uuid===t)},get isEditable(){return e.isEditable},get link(){return e.link}})}})}})})}})}function ja(e){const t=()=>gn(e.entry$.get());return[(()=>{var n=g(Ca);return u(n,()=>e.entry$.get().title),n})(),(()=>{var n=g(Pa),r=n.firstChild,i=r.firstChild,a=i.firstChild,[s,o]=m(a.nextSibling),c=s.nextSibling,[d,h]=m(c.nextSibling),b=d.nextSibling,[v,S]=m(b.nextSibling),k=v.nextSibling,[f,_]=m(k.nextSibling),y=f.nextSibling,[x,R]=m(y.nextSibling),w=x.nextSibling,[P,L]=m(w.nextSibling),O=P.nextSibling,[M,I]=m(O.nextSibling),Q=r.nextSibling,W=Q.firstChild,X=W.nextSibling,Z=X.nextSibling,p=Z.firstChild,[A,H]=m(p.nextSibling),ee=A.nextSibling,[ge,q]=m(ee.nextSibling),B=Z.nextSibling,te=B.nextSibling,[N,G]=m(te.nextSibling),ae=N.nextSibling,De=ae.nextSibling;return u(i,l(Oe,{get value$(){return e.entry$.pipe(T.sub("title"))},label:"Titel",name:"title",get showErrors(){return e.entry$.get().status==="published"?"ALWAYS":"ON_BLUR"},get errors(){return t().byField.title??[]},get disabled(){return!e.isEditable}}),s,o),u(i,l(Oe,{get value$(){return e.entry$.pipe(T.sub("organizer"))},label:"Organisiert durch",name:"organizer",get showErrors(){return e.entry$.get().status==="published"?"ALWAYS":"ON_BLUR"},get errors(){return t().byField.organizer??[]},get disabled(){return!e.isEditable}}),d,h),u(i,l(Ht,{get value$(){return e.entry$.pipe(T.sub("shortDescription"))},label:"kurze Beschreibung",name:"descriptionShort",size:"small",get showErrors(){return e.entry$.get().status==="published"?"ALWAYS":"ON_BLUR"},get errors(){return t().byField.shortDescription??[]},get disabled(){return!e.isEditable}}),v,S),u(i,l(Ht,{get value$(){return e.entry$.pipe(T.sub("longDescription"))},label:"lange Beschreibung (optional)",name:"descriptionLong",get showErrors(){return e.entry$.get().status==="published"?"ALWAYS":"ON_BLUR"},get errors(){return t().byField.longDescription??[]},get disabled(){return!e.isEditable}}),f,_),u(i,l(Za,{get value$(){return e.entry$.pipe(T.sub("participating"))}}),x,R),u(i,l(Va,{get slots$(){return e.entry$.pipe(T.sub("timeSlots"))}}),P,L),u(i,l(Oe,{get value$(){return e.entry$.pipe(T.sub("tagNames"))},label:"Tags",name:"tags",get showErrors(){return e.entry$.get().status==="published"?"ALWAYS":"ON_BLUR"},get errors(){return t().byField.tags??[]},get disabled(){return!e.isEditable}}),M,I),u(Z,l(He,{get kind(){return t().hasErrors?"danger":"special"},get children(){return["Status: ",z(()=>C.publishingSteps[e.entry$.get().status]),z(()=>z(()=>!!t().hasErrors)()?(()=>{var se=g(Fa),Pe=se.firstChild,Fe=Pe.nextSibling,[Le,rt]=m(Fe.nextSibling);return u(se,l(ue,{icon:"triangle-exclamation"}),Le,rt),se})():"")]}}),A,H),u(Z,l(mn,{get value$(){return e.entry$.pipe(T.sub("status"))},options:{left:{label:"Entwurf",value:"draft"},right:{label:"Veröffentlicht",value:"published"}},name:"status"}),ge,q),u(Q,l(D,{get when(){return e.entry$.get().status==="published"},get children(){return l(Ka,{get errors(){return t()}})}}),N,G),u(De,l(J,{get each(){return Wa(e.entry$.get())},get fallback(){return g(La)},children:se=>l(pa,{entry:se,basePath:"/programm",get link(){return e.link},reservations:0})})),n})()]}function Ka(e){return l(D,{get when(){return e.errors.hasErrors},get children(){return l(E,{type:"danger",get children(){return[g(Ia),g(Na),(()=>{var t=g(Ya);return u(t,l(J,{get each(){return e.errors.allErrors},children:n=>(()=>{var r=g($n);return u(r,n),r})()})),t})()]}})}})}function Wa(e){const t=[];return e.timeSlots.forEach(n=>{const r=Ge(n.start.time),i=Ge(n.end.time);r.kind==="ERROR"||i.kind==="ERROR"||t.push({uuid:n.uuid,title:e.title,organizer:e.organizer,timeSlot:{startDate:tt[n.start.day].toPlainDateTime({hour:r.value.hour,minute:r.value.minute}),endDate:tt[n.end.day].toPlainDateTime({hour:i.value.hour,minute:i.value.minute})},shortDescription:e.shortDescription,longDescription:e.longDescription,participating:e.participating,tagNames:e.tagNames})}),t}function Za(e){return[l(mn,{get value$(){return e.value$.pipe(T.sub("kind"))},options:{left:{label:"Keine Anmeldung",value:"NONE"},right:{label:"Limitierte Plätze",value:"LIMITED"}},name:"participating"}),l(D,{get when(){return e.value$.get().kind==="LIMITED"},get children(){return l(_a,{get value$(){return e.value$.pipe(T.sub("maxSeats"))},label:"Maximale Plätze",name:"maxSeats"})}})]}function Va(e){return[g(Oa),(()=>{var t=g(Ba),n=t.firstChild,[r,i]=m(n.nextSibling),a=r.nextSibling;return u(t,l(J,{get each(){return e.slots$.get()},children:s=>{const o=re.findExact(e.slots$,c=>c.uuid===s.uuid);return(()=>{var c=g($n);return u(c,l(E,{onClose:()=>re.remove(e.slots$,d=>d.uuid!==s.uuid),get children(){var d=g(za),h=d.firstChild,b=h.firstChild,v=b.nextSibling,S=v.firstChild,[k,f]=m(S.nextSibling),_=k.nextSibling,[y,x]=m(_.nextSibling),R=h.nextSibling,[w,P]=m(R.nextSibling),L=w.nextSibling,[O,M]=m(L.nextSibling);return u(v,l(oe,{label:"Samstag",get kind(){return s.start.day==="SATURDAY"?"success":"gray"},onClick:()=>{re.findExact(e.slots$,I=>I.uuid===s.uuid).update(I=>({...I,start:{...I.start,day:"SATURDAY"},end:{...I.end,day:"SATURDAY"}}))}}),k,f),u(v,l(oe,{label:"Sonntag",get kind(){return s.start.day==="SUNDAY"?"success":"gray"},onClick:()=>{re.findExact(e.slots$,I=>I.uuid===s.uuid).update(I=>({...I,start:{...I.start,day:"SUNDAY"},end:{...I.end,day:"SUNDAY"}}))}}),y,x),u(d,l(Oe,{get value$(){return o.pipe(T.sub("start")).pipe(T.sub("time"))},label:"Start",name:"start"}),w,P),u(d,l(Oe,{get value$(){return o.pipe(T.sub("end")).pipe(T.sub("time"))},label:"Ende",name:"end"}),O,M),d}})),c})()}}),r,i),u(a,l(_e,{icon:"circle-plus",type:"success",onClick:()=>re.push(e.slots$,{uuid:crypto.randomUUID(),start:{day:"SATURDAY",time:"10:00"},end:{day:"SATURDAY",time:"12:00"}}),get children(){return g(Ha)}})),t})()]}const qa=F({name:U(),slot:F({day:et,from:de(),to:de()})}),Ja=kn(),Ga=F({entries:Ae(qa)}),Qa=F({admin:Ja,erklaerbaer:yn(Ga)});async function Xa(e){const t=await Bn(e);if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=Qa.safeParse(t.data);return n.success?{kind:"SUCCESS",data:n.data}:{kind:"FAILURE"}}function es(e){const[t]=Ve(Ii),[n]=Ve(()=>Xa(e.secret)),r=ul({meta:{saveState:"IDLE",lastSaved:new Date,roles:e.initState.roles},save:e.initState.data}),i=crypto.randomUUID(),[a,s]=ie(!1);Ve(()=>JSON.stringify(r.get().save),async()=>{if(!a()){s(!0);return}if(e.initState.status!=="published"){qt("Diese Anmeldung wurde deaktiviert und kann nicht editiert werden.",{kind:"danger",uuid:i});return}const c=Ln(r.get().save);try{const d=await ar(r.get().meta,c,e.secret);d.kind==="FAILURE"?console.error(d):r.pipe(T.sub("meta")).pipe(T.sub("lastSaved")).set(d.data)}catch(d){console.error(d),r.pipe(T.sub("meta")).pipe(T.sub("saveState")).set("ERROR")}});function o(c){return`${c}?secret=${e.secret}`}return l(ii,{explicitLinks:!0,children:[{path:"/",component:()=>l(be,{title:"Wo möchtest du starten?",get roles(){return r.get().meta.roles},link:o,get saveState(){return r.get().meta.saveState},get lastSaved(){return r.get().meta.lastSaved},get children(){return l(bi,{get roles(){return r.get().meta.roles},link:o})}})},{path:"/programm",component:()=>l(be,{title:"Programm",get roles(){return r.get().meta.roles},link:o,get saveState(){return r.get().meta.saveState},get lastSaved(){return r.get().meta.lastSaved},get children(){return l(ha,{})}})},{path:"/erstellen",component:()=>l(be,{title:"Programmpunkte erstellen und editieren",get roles(){return r.get().meta.roles},link:o,get saveState(){return r.get().meta.saveState},get lastSaved(){return r.get().meta.lastSaved},get children(){return l(Sa,{get programEntries$(){return r.pipe(T.sub("save")).pipe(T.sub("program")).pipe(T.sub("organising"))},link:o,get isEditable(){return e.initState.status==="published"}})}})},{path:"/erstellen/:uuid",component:()=>l(be,{get roles(){return r.get().meta.roles},link:o,get saveState(){return r.get().meta.saveState},get lastSaved(){return r.get().meta.lastSaved},parentPath:"/erstellen",get children(){return l(Ma,{get programEntries$(){return r.pipe(T.sub("save")).pipe(T.sub("program")).pipe(T.sub("organising"))},publicResource:t,link:o,get isEditable(){return e.initState.status==="published"}})}})},{path:"/helfen",component:()=>l(be,{title:"Helfen",get roles(){return r.get().meta.roles},link:o,get saveState(){return r.get().meta.saveState},get lastSaved(){return r.get().meta.lastSaved},showQuickmenu:!0,get children(){return l(Ki,{get reservations$(){return r.pipe(T.sub("save")).pipe(T.sub("helping"))},publicResource:t,get isEditable(){return e.initState.status==="published"},link:o,get roles(){return r.get().meta.roles}})}})},{path:"/helfen/:uuid",component:()=>l(be,{link:o,get roles(){return r.get().meta.roles},get saveState(){return r.get().meta.saveState},get lastSaved(){return r.get().meta.lastSaved},showQuickmenu:!0,parentPath:"/helfen",get children(){return l(Bl,{get reservations$(){return r.pipe(T.sub("save")).pipe(T.sub("helping"))},publicResource:t,link:o,get isEditable(){return e.initState.status==="published"}})}})},{path:"/erklaerbaer",component:()=>l(be,{title:"Helfen: Erklärbären",get roles(){return r.get().meta.roles},link:o,get saveState(){return r.get().meta.saveState},get lastSaved(){return r.get().meta.lastSaved},showQuickmenu:!0,parentPath:"/helfen",get children(){return l(ua,{get save$(){return r.pipe(T.sub("save"))},adminResource:n,get roles(){return r.get().meta.roles},get isEditable(){return e.initState.status==="published"}})}})},{path:"/zusammenfassung",component:()=>l(be,{title:"Zusammenfassung",get roles(){return r.get().meta.roles},link:o,get saveState(){return r.get().meta.saveState},get lastSaved(){return r.get().meta.lastSaved},showQuickmenu:!0,get children(){return l(fl,{get save$(){return r.pipe(T.sub("save"))},publicResource:t,link:o,get isEditable(){return e.initState.status==="published"}})}})},{path:"*",component:()=>l(be,{title:"Seite nicht gefunden",get roles(){return r.get().meta.roles},link:o,get saveState(){return r.get().meta.saveState},get lastSaved(){return r.get().meta.lastSaved},showQuickmenu:!0,get children(){return l(E,{type:"danger",get children(){return C.error.siteNotFound}})}})}]})}function ts(){return l(E,{get children(){return C.loading.registration}})}function us(){const t=URL.parse(location.toString().replace("#/",""))?.searchParams.get("secret")??"no-secret-found",[n]=Ve(()=>ir(t));return l(Vt,{fallback:r=>(console.error(r),l(E,{type:"danger",get children(){return C.error.general}})),get children(){return l(je,{get fallback(){return l(ts,{})},get children(){return l(Me,{get children(){return l(he,{get when(){return n()},children:r=>{const{kind:i,value:a}=xn(r());return i==="FAILURE"?a.reason==="SECRET_INVALID"?l(E,{type:"danger",get children(){return C.error.secretError}}):(console.error(a),l(E,{type:"danger",get children(){return C.error.ourMistake}})):l(es,{get initState(){return a.data},secret:t})}})}})}})}})}export{us as MeineAnmeldungWrapper};
